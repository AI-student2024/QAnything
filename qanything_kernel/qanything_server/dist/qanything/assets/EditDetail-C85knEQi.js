import{_ as Ce}from"./bot-avatar-CBCRm2Zm.js";import{_ as We}from"./knowledge-zhu8jsrY.js";import{u as pe}from"./useBots-nm0MdBxE.js";import{r as te,u as oe,a as Pe,b as je,C as Ne}from"./utils-DMQccJQa.js";import{g as he,u as Ge}from"./index-CXmHDMVd.js";import{b as $e,C as Je,a as et}from"./ChatInfoPanel-76xncpRm.js";import{u as Se}from"./useChatSetting-CWifA4XP.js";import{u as _e}from"./useBotsChat-1Nv_04Gs.js";import{d as ge,x as H,r as A,a as Be,o as tt,y as i,J as d,B as t,c,D as s,E as se,C as p,L as M,T as Q,F as X,K as ae,A as V,G as w,X as Te,Y as Ie,H as ve,i as ot,N as F,O as D,R as K,a6 as st,a0 as ue,z as be,S,a3 as at,M as de,p as nt}from"./index-vLLWhXaM.js";import{I as xe,_ as lt}from"./ActionButton-Cu6LdVgt.js";import{B as Fe}from"./RightOutlined-DYvilZv7.js";import{u as ct,a as it,b as rt,D as ut,h as dt,c as De,_ as pt,T as ht,f as _t}from"./html2canvas.esm-DVFZ3d3A.js";import{_ as gt}from"./lock-DmQwPPsI.js";import{u as vt,_ as ft,I as mt}from"./useChatSource-DtDJ0b1m.js";import"./index-BIwI-sY_.js";import"./index-BVuDUlPp.js";import"./initDefaultProps-zQa7oZMX.js";import"./slide-DOGE1U_k.js";import"./index-BFcUdsh2.js";import"./responsiveObserve-DS4BXwCA.js";import"./collapseMotion-D8hX_AOB.js";import"./class-DeKWk5pD.js";const kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAQBSURBVFiF1Zk/aBtnFMB/73TWUJwUi0CoS4KHxEPw4n+0aQMpGWwPLaQYeywt0l0OFxwC7ZohawuhHoR9Z2jwaFEayFDbgyGQ4BaEp5DBWURCFZoauSTOoujuZdB3RpKNY8e25P4m6b67e7+7033fe0/C+yGO41wErgADItINdAInzPgroKiqa0AeWA6CYAXQfQfaz86u655V1QkR+Qb4aJ+xnqvqnIhkfd9/eqiCmUzmdCKRuKmqDtBmNj8BFkXkgao+LpfLz7q6ul4CFAqFk8lk8oyIXFDVS8AwcN4c90ZEgjAMb83Ozv5zYEHHcb4VkZ+AU0AFmAemfN//ay8XF+O67ifAJDAO2MC6qv4YBMGd9xIcGxtLplKp26o6YTYtqOr1IAjW9iPWiOM43SLyCzACICLZUql0I5fLlfcsODEx0V6pVH4DhoBN4Aff92cOItaI67rXgJ+BdmDJtu3RbDa7+U7BsbGxZEdHxz1gSFWLiURieHp6+tFhysV4ntcThuGiiHQCSxsbG1813kmr8aBUKnU7loui6PJRyQFMT08/iqLosqoWgSETu466O2heiF+BTcuyLh6lXC2e5/VEUbQCtKvqd7UvTiL+kMlkTluWdRf4AJicmZn5oxlyAPl8/kV/f38J+FJELvX29s6trq6+hppHnEgkblKdShYO+4XYCybmAnDKuLAlaFYIB6io6vVmy8WY2BVVdVzXPbslaOa6NmD+oPPcQTCx54G2eP61ADFrK8BUq+RqmAIwTiKO43wmIg+BJ77vd7fWrYrrumvAeVX93KKaMgEsttCpkdjligUMAIjIg9b51FPjMmCZZBNVfdxCpzpiFxHptqhmwpTL5WcttaqhxqXTxqTpcbK5G67r/g5cPWD8u77vf73bDl1dXS+LxSLAiW3JwnHDplrgfFgoFE4C/+2287uu/LAwJQPAKwsoAiSTyTPNCL4XalyKlikNEZELLXSqI3ZR1TWLat2Kqb6OBTUueQtYNl+GW+SzE7HLsgDiuu7fVAvxT/dbTh42pjz9E3ju+/7HFqCqOmfGJ1untsUkgHFSC6q1KfAGGHccp2UZjYk9TrX7kAWTsPq+/1REAsA2RXVLMLFtEQni/s3WShKG4S1gHRgxRXVTMTFHgHXjAtRUdaurq6/7+vr+FZGrwBeDg4P38vn8i2bIeZ7Xo6rzQFJVv5+dnX0Yj9WtxUEQ3DHPvj0Mw8V0On3uqOXS6fS5MAwXgXYRyTY2k7YlC6VS6QawJCKdlmXd9zyv56jkPM/rsSzrftz6MLHr2CaYy+XKtm2PxpJRFK0cxW/Sdd1rURStxHK2bY/u1OH6f7bfGk54PBuYtRzrFnAtx7aJvtNxzfob4i2ESvnrjyWOcQAAAABJRU5ErkJggg==",At="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAOBSURBVFiFzZixdeJAEIb/WZAiAjqADiiBwAUQOHOg97BlhQQUQEABBIRCZ7+ngMwBBThQARfQgegAv4cTOHYuuFksQBJIYM5/AojVzqcZ7ezsEDNX8IOl/jfAKVUvuTkMw/p6vW4TUUNrXWfmBgAQ0UIptWTmhW3bkeM4y7I2qGiIwzCsbzYbZ7vddoioxcz1k0aIZkQ0c103/FZA3/d7RDQwUES0ZOY5gDkRLYkoBgBmbsqYFoB2YopYKTUsAnoW4Ovra2uz2bwBaMqlSCk1Pid85jXQWvcSsHGtVrt7eHhYXAwYBIHDzCPxSCQeiE5NnDWX1noAoCkef3Jdd1YacDKZDJh5ID/Hnuf1y4Adyvf9EYAeABDR8Pn5eVgYMAiCjtb6TX72Pc8bXwPOKPnwSqnHrPcyFXA6nTY+Pz9/M3P91BNeIt/3ewBGRLSsVqt33W53fjgmNVGvVqt3eefG3wUHABKVMTPXZREe6QgwCAIH/1ZrfK13Lk9iIwLQFI/mA8oqg1KqsOeCIHDSjJySsUVEgzAM9xL/HmDCe1GZrK+1fgEwKnqfpK1IQu1kAjJzBwCUUlddsefI2Nxut5296+ZLGIZ1A2jbdqlEfIls244kebeSYd4Brtdrsw1dVH2UleM4S2aeM3M9wfIFSEQN+XqUi26o+QHLF6DWeleh3J7rn4xtwwIkCtZEsRnnTSIb/kveGN/3/2T8lbtlElHMzDsWoETJn3y6olJKFY7OzoNEtBD6Zt4NZntK+894zvO8UkcJY5uIdnVicpHEMqi0hy6VsZ30dDLEH/LZuiXUgVoAwMzHHsxKlLeS2GwbliPArER5KxmbRDRLbhR7q7hSqcwAQA44N5WxSUR7Z5Q9QMuyQkmW7SAIynixr5R6LHqTVFFtAPFhFbUHKGEeAl91YRF5njcuWaZl1qBHiVryXAygLaevb5XYaCLFe6mAAGBZ1r2EulemQj5Xk8lkAKBHRMtarXaXNiYVsNvtzonInEdGMtFV5ft+zxw7iegpq8uQuRe7rhsS0RAAmHlwzXDLXCOBG+Z1F85pfXSY+ZdsQ4WbPwdztWVBtGVT6J+a66zm0XQ6baxWq3dcsXlkWdZ92kG9FKBRsvmTuBwhp/2W7CFKu25YpI1SuIFpQJm5Yw5ZuQakh1ipVGaWZYVFzzulAI3yWsDizY+bt4BvrR/f5f8LxA8rSSHVBD4AAAAASUVORK5CYII=",ne=v=>(Te("data-v-5f0304fb"),v=v(),Ie(),v),wt={class:"bot-detail-edit-comp"},yt={class:"name-avatar"},bt=ne(()=>t("img",{src:Ce,alt:"avatar"},null,-1)),Ct={class:"title"},St={class:"title"},Bt={class:"title"},Tt=ne(()=>t("span",null,"*",-1)),It=ne(()=>t("img",{class:"knowledge-icon",src:We,alt:"knowledge"},null,-1)),xt={class:"kb-name"},Ft=["onClick"],Dt=ne(()=>t("img",{class:"add-knowedge",src:At,alt:"icon"},null,-1)),Lt={class:"save"},Rt={class:"title"},qt={class:"chat-setting-form-footer"},Et=ge({__name:"BotDetailEdit",setup(v,{expose:Z}){const{curBot:u,knowledgeList:O}=H(pe()),{QA_List:L}=H(_e()),{setSelectKnowledgeVisible:g,setCurBot:_}=pe(),{setChatSettingConfigured:le}=Se(),{bots:y,common:j}=he(),R=A(""),q=A(""),E=A(""),k=Be(()=>q.value.match(/[^a-zA-Z\s]|\p{P}|\w+/g));tt(()=>{console.log("curBot",u.value),R.value=u.value.bot_name,E.value=u.value.welcome_message,q.value=u.value.prompt_setting});const N=async b=>{try{const l=await te(await oe.queryBotInfo({bot_id:b}));console.log("getBotInfo",l),_(l[0])}catch(l){w.error(l.msg||"获取Bot信息失败")}},B=async()=>{try{await te(await oe.updateBot({bot_id:u.value.bot_id,bot_name:R.value,prompt_setting:q.value,welcome_message:E.value})),N(u.value.bot_id),w.success(y.saveSuccessful)}catch(b){console.log("error--",b),w.error(b.msg||"保存失败，请重试")}},T=async b=>{let l=u.value.kb_ids;console.log("removeKb",b,l),l=l.filter(m=>m!=b);try{await te(await oe.updateBot({bot_id:u.value.bot_id,kb_ids:l})),N(u.value.bot_id),O.value=O.value.map(m=>(m.kb_id===b&&(m.state=m.state===0?1:0),m)),w.success(y.removalSucessful)}catch(m){w.error(m.msg||"请求失败")}},I=A(),z=async(b,l="应用成功")=>{const m=await I.value.onCheck();return Object.hasOwn(m,"errorFields")?!1:(le(m),console.log(l),w.success(l),!0)};return Z({handleOk:z}),(b,l)=>{const m=xe,G=lt,$=Fe;return i(),d("div",wt,[t("div",yt,[bt,c(m,{value:s(R),"onUpdate:value":l[0]||(l[0]=C=>se(R)?R.value=C:null),placeholder:s(y).inputBotName,"show-count":"",maxlength:20},null,8,["value","placeholder"])]),t("div",Ct,p(s(y).roleSetting),1),c(G,{value:s(q),"onUpdate:value":l[1]||(l[1]=C=>se(q)?q.value=C:null),class:"role-setting-input","auto-size":{minRows:7,maxRows:7},rows:7},null,8,["value"]),t("div",{class:M(["role-setting-length",s(k)&&s(k).length>2e3?"over-length":""])},p(s(k)?s(k).length:0)+" / 2000 ",3),t("div",St,p(s(y).welcomeMessage),1),c(G,{value:s(E),"onUpdate:value":l[2]||(l[2]=C=>se(E)?E.value=C:null),class:"greeting-input","show-count":"",maxlength:100,placeholder:s(y).inputWelcomMsg,"auto-size":{minRows:6,maxRows:6},rows:6},null,8,["value","placeholder"]),t("div",Bt,[Q(p(s(y).associatedKb),1),Tt]),(i(!0),d(X,null,ae(s(u).kb_ids,(C,J)=>(i(),d("div",{key:C,class:"knowedge-item knowledge-info"},[It,t("div",xt,p(s(u).kb_names[J]),1),t("img",{class:"remove-icon",src:kt,alt:"remove",onClick:Y=>T(C)},null,8,Ft)]))),128)),t("div",{class:"knowedge-item add-knowledge-content",onClick:l[3]||(l[3]=C=>s(g)(!0))},[Dt,Q(" "+p(s(y).clickAssociatedKb),1)]),t("div",Lt,[c($,{class:"save-btn",type:"primary",onClick:B},{default:V(()=>[Q(p(s(y).save),1)]),_:1})]),t("div",Rt,p(s(j).modelSettingTitle),1),c($e,{ref_key:"chatSettingFormRef",ref:I,"context-length":s(L).length},null,8,["context-length"]),t("div",qt,[c($,{type:"primary",style:{width:"auto"},onClick:z},{default:V(()=>[Q(p(s(j).confirmApplication),1)]),_:1})])])}}}),Ut=ve(Et,[["__scopeId","data-v-5f0304fb"]]),P=v=>(Te("data-v-c8969e72"),v=v(),Ie(),v),Kt={class:"bots-chat-container"},Vt={class:"my-page"},Ht={class:"header"},Qt=P(()=>t("img",{src:Ce,alt:"avatar"},null,-1)),Ot={id:"chat",class:"chat"},zt={class:"ai"},Yt={class:"content"},Mt=P(()=>t("img",{class:"avatar",src:De,alt:"头像"},null,-1)),Xt=["innerHTML"],Zt={key:0,class:"user"},Wt=P(()=>t("img",{class:"avatar",src:pt,alt:"头像"},null,-1)),Pt={class:"question-text"},jt={key:1,class:"ai"},Nt={class:"content"},Gt=P(()=>t("img",{class:"avatar",src:De,alt:"头像"},null,-1)),$t={key:1},Jt={key:0},eo={key:1},to={class:"source-list"},oo={class:"control"},so={class:"tips"},ao=["href"],no=["onClick"],lo={class:"source-content"},co=["innerHTML"],io={class:"score"},ro={class:"tips"},uo={key:2,class:"feed-back"},po=["onClick"],ho={class:"reload-text"},_o={class:"tools"},go={class:"stop-placeholder"},vo={class:"question-box"},fo={class:"question"},mo={class:"send-plane"},ko={key:0,class:"mask"},Ao=P(()=>t("img",{src:gt,alt:"icon"},null,-1)),wo=ge({__name:"Chat",props:{chatType:{type:String,default:"edit"},botInfo:{type:Object,default:()=>{}}},setup(v){const Z=v,u=he().common,O=he().bots,L=new ht(e=>{e&&(g.value[g.value.length-1].answer+=e||"")}),{QA_List:g}=H(_e()),{chatSettingFormActive:_}=H(Se()),{copy:le}=ct(),{setChatSourceVisible:y,setSourceType:j,setSourceUrl:R,setTextContent:q}=vt(),{language:E}=H(Ge()),k=A(""),N=Be(()=>{const e=_.value.context;if(e===0)return[];const a=g.value.filter(n=>n.type==="ai");return(e===11?a:a.slice(-e)).map(n=>[n.question,n.answer])}),B=A(!1),T=A([]);let I;const z=A(null),b=A(null),l=()=>{ue(()=>{var e;(e=z.value)==null||e.scrollIntoView(!1)})},m=it((e,a)=>{if(e.like=!e.like,e.unlike=!1,e.like){a.target.parentNode.style.animation="shake ease-in .5s";const f=setTimeout(()=>{clearTimeout(f),a.target.parentNode.style.animation=""},600)}},800),G=e=>{e.unlike=!e.unlike,e.like=!1},$=e=>{le(e.answer).then(()=>{e.copied=!e.copied,w.success(u.copySuccess,1);const a=setTimeout(()=>{clearTimeout(a),e.copied=!e.copied},1e3)}).catch(()=>{w.error(u.copyFailed,1)})},C=e=>{g.value.push({question:e,type:"user"}),l()},J=e=>{g.value.push({answer:"",question:e,onlySearch:_.value.capabilities.onlySearch,type:"ai",copied:!1,like:!1,unlike:!1,source:[],picList:null,showTools:!1})},Y=new Ne,Le=()=>{I&&I.abort(),L.done(),B.value=!1,g.value[g.value.length-1].showTools=!0},ce=async()=>{var f;if(!k.value.trim().length)return;if(!k.value.length){w.warn("正在聊天中...请等待结束");return}if(!await ze()){w.error("模型设置错误，请先检查模型配置");return}const e=k.value;k.value="",C(e),B.value=!0,(f=z.value)==null||f.scrollIntoView(!0),I=new AbortController;const a={"Content-Type":"application/json",Accept:["text/event-stream","application/json"],"Transfer-Encoding":"chunked",Connection:"keep-alive"};_t(je+"/local_doc_qa/local_doc_chat",{method:"POST",headers:a,openWhenHidden:!0,body:JSON.stringify({user_id:Pe,bot_id:Z.botInfo.bot_id,history:N.value,question:e,streaming:_.value.capabilities.onlySearch===!1,networking:_.value.capabilities.networkSearch,product_source:"saas",rerank:_.value.capabilities.rerank,only_need_search_results:_.value.capabilities.onlySearch,hybrid_search:_.value.capabilities.mixedSearch,max_token:_.value.maxToken,api_base:_.value.apiBase,api_key:_.value.apiKey,model:_.value.apiModelName,api_context_length:_.value.apiContextLength,chunk_size:_.value.chunkSize,top_p:_.value.top_P,top_k:_.value.top_K,temperature:_.value.temperature}),signal:I.signal,onopen(n){console.log("open"),Y.addChatSetting(_.value),n.ok&&n.headers.get("content-type")==="text/event-stream"?(console.log("everything's good"),J(e),L.start()):n.headers.get("content-type")==="application/json"&&J(e)},onmessage(n){var o;console.log("message");const r=JSON.parse(n.data);if(console.log(r),(r==null?void 0:r.code)==200&&(r!=null&&r.response)&&r.msg==="success")L.add(r==null?void 0:r.response.replaceAll(`
`,"<br/>")),l();else{const x=r.time_record.time_usage;delete x.retriever_search_by_milvus,Y.addTime(r.time_record.time_usage),Y.addToken(r.time_record.token_usage),Y.addDate(Date.now())}(o=r==null?void 0:r.source_documents)!=null&&o.length&&(g.value[g.value.length-1].source=r==null?void 0:r.source_documents)},onclose(n){console.log("close",n),L.done(),I.abort(),B.value=!1,g.value[g.value.length-1].showTools=!0,g.value.at(-1).itemInfo=Y.getChatInfo(),ue(()=>{l()})},onerror(n){throw console.log("error",n),L.done(),I.abort(),B.value=!1,g.value[g.value.length-1].showTools=!0,ue(()=>{l()}),n}})},Re=e=>{console.log("reAnswer"),k.value=e.question,ce()},qe=(e,a)=>{e.source[a].showDetailDataSource=!1},Ee=(e,a)=>{e.source[a].showDetailDataSource=!e.source[a].showDetailDataSource},Ue=e=>{T.value.push(e)},Ke=e=>{T.value=T.value.filter(a=>a!==e)},{showModal:fe}=H(rt()),{clearQAList:Ve}=_e(),ie=A(!1),re=A(""),ee=A(""),He=()=>{ee.value="download",fe.value=!0,re.value=u.saveTip},Qe=async()=>{if(ie.value=!0,ee.value==="download"){console.log("download");try{const e=document.getElementById("chat-ul"),f=(await dt(e,{useCORS:!0})).toDataURL("image/png"),n=document.createElement("a");n.style.display="none",n.href=f,n.setAttribute("download","chat-shot.png"),typeof n.download>"u"&&n.setAttribute("target","_blank"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(f),w.success(O.downloadSuccessful),Promise.resolve()}catch(e){console.log(e),w.error(e.message||e.msg||"出错了")}}else ee.value==="delete"&&(console.log("delete"),Ve());ee.value="",re.value="",ie.value=!1,fe.value=!1},Oe=ot("checkSettingOk"),ze=async()=>await Oe();let me=["pdf","docx","xlsx","txt","jpg","png","jpeg"];const ke=e=>{if(!e)return!1;const a=e.split(".");if(a.length){const f=a.pop();return!!me.includes(f)}else return!1},Ye=e=>{console.log("handleChatSource",e),ke(e.file_name)&&Me(e)};async function Me(e){try{R(null);const a=await te(await oe.getFile({file_id:e.file_id}));console.log("queryFile",a);const f=e.file_name.split(".").pop(),n=Ze(f);if(console.log("b64Type",n),j(f),R(`data:${n};base64,${a.base64_content}`),f==="txt"){const r=atob(a.base64_content),o=decodeURIComponent(escape(r));console.log("decodedTxt",o),q(o),y(!0)}else y(!0)}catch(a){w.error(a.msg||"获取文件失败")}}let Xe=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","image/jpeg","image/png","image/jpeg"];function Ze(e){const a=me.indexOf(e);return Xe[a]}return l(),(e,a)=>{const f=mt,n=Fe,r=xe;return i(),d(X,null,[t("div",Kt,[t("div",Vt,[t("div",Ht,[Qt,Q(" "+p(v.botInfo.bot_name),1)]),t("div",Ot,[t("ul",{id:"chat-ul",ref_key:"scrollDom",ref:z},[t("div",zt,[t("div",Yt,[Mt,t("p",{class:"question-text",innerHTML:v.botInfo.welcome_message},null,8,Xt)])]),(i(!0),d(X,null,ae(s(g),(o,x)=>{var Ae,we,ye;return i(),d("li",{key:x},[o.type==="user"?(i(),d("div",Zt,[Wt,t("p",Pt,p(o.question),1)])):(i(),d("div",jt,[t("div",Nt,[Gt,o.onlySearch?K("",!0):(i(),d("p",{key:0,class:M(["question-text",[!o.source.length&&!((Ae=o==null?void 0:o.picList)!=null&&Ae.length)?"change-radius":"",o.showTools?"":"flashing"]])},[o.answer?(i(),be(ft,{key:0,content:o.answer},null,8,["content"])):(i(),d("span",$t,p(o.answer),1)),Object.keys(((we=o==null?void 0:o.itemInfo)==null?void 0:we.tokenInfo)||{}).length?(i(),be(Je,{key:2,"chat-item-info":o.itemInfo},null,8,["chat-item-info"])):K("",!0)],2))]),(ye=o==null?void 0:o.picList)!=null&&ye.length?(i(!0),d(X,{key:0},ae(o.picList,(h,U)=>(i(),d("div",{key:h+U,class:M(["data-picList",!o.source.length&&U+1===o.picList.length?"picList-radius":""])},[c(f,{width:150,src:h,class:"responsive-image"},null,8,["src"])],2))),128)):K("",!0),o.source.length?(i(),d(X,{key:1},[t("div",{class:M(["source-total",s(T).includes(x)?"":"source-total-last"])},[s(E)==="zh"?(i(),d("span",Jt,"找到了"+p(o.source.length)+"个信息来源：",1)):(i(),d("span",eo,"Found "+p(o.source.length)+" source of information",1)),F(c(S,{name:"down",onClick:h=>Ue(x)},null,8,["onClick"]),[[D,!s(T).includes(x)]]),F(c(S,{name:"up",onClick:h=>Ke(x)},null,8,["onClick"]),[[D,s(T).includes(x)]])],2),F(t("div",to,[(i(!0),d(X,null,ae(o.source,(h,U)=>(i(),d("div",{key:U,class:"data-source"},[F(t("p",oo,[t("span",so,p(s(u).dataSource)+p(U+1)+":",1),h.file_id.startsWith("http")?(i(),d("a",{key:0,href:h.file_id,target:"_blank"},p(h.file_name),9,ao)):(i(),d("span",{key:1,class:M(["file",ke(h.file_name)?"filename-active":""]),onClick:W=>Ye(h)},p(h.file_name),11,no)),F(c(S,{name:"iconup",onClick:W=>qe(o,U)},null,8,["onClick"]),[[D,h.showDetailDataSource]]),F(c(S,{name:"icondown",onClick:W=>Ee(o,U)},null,8,["onClick"]),[[D,!h.showDetailDataSource]])],512),[[D,h.file_name]]),c(at,{name:"sourceitem"},{default:V(()=>{var W;return[F(t("div",lo,[t("p",{innerHTML:(W=h.content)==null?void 0:W.replaceAll(`
`,"<br/>")},null,8,co),t("p",io,[t("span",ro,p(s(u).correlation),1),Q(p(h.score),1)])],512),[[D,h.showDetailDataSource]])]}),_:2},1024)]))),128))],512),[[D,s(T).includes(x)]])],64)):K("",!0),o.showTools?(i(),d("div",uo,[t("div",{class:"reload-box",onClick:h=>Re(o)},[c(S,{name:"reload"}),t("span",ho,p(s(u).regenerate),1)],8,po),t("div",_o,[c(S,{style:de({color:o.copied?"#4D71FF":""}),name:"copy",onClick:h=>$(o)},null,8,["style","onClick"]),c(S,{style:de({color:o.like?"#4D71FF":""}),name:"like",onClick:h=>s(m)(o,h)},null,8,["style","onClick"]),c(S,{style:de({color:o.unlike?"#4D71FF":""}),name:"unlike",onClick:h=>G(o)},null,8,["style","onClick"])])])):K("",!0)]))])}),128)),F(t("div",go,null,512),[[D,s(B)]]),F(t("div",{ref_key:"stopBtn",ref:b,class:"stop-btn"},[c(n,{onClick:Le},{icon:V(()=>[c(S,{name:"stop",class:M(s(B)?"loading":"")},null,8,["class"])]),default:V(()=>[Q(" "+p(s(u).stop),1)]),_:1})],512),[[D,s(B)]])],512)]),t("div",vo,[t("div",fo,[v.chatType==="share"?(i(),d("span",{key:0,class:"download",onClick:He},[c(S,{name:"chat-download"})])):K("",!0),c(r,{value:s(k),"onUpdate:value":a[0]||(a[0]=o=>se(k)?k.value=o:null),"max-length":"200",placeholder:s(u).problemPlaceholder,onKeyup:st(ce,["enter"])},{suffix:V(()=>[t("div",mo,[c(n,{type:"primary",disabled:s(B),onClick:ce},{default:V(()=>[c(S,{name:"sendplane"})]),_:1},8,["disabled"])])]),_:1},8,["value","placeholder"])])])]),!v.botInfo.kb_ids||!v.botInfo.kb_ids.length?(i(),d("div",ko,[Ao,t("p",null,p(s(O).bindKbtoPreview),1)])):K("",!0),c(et,{ref:"chatSettingForDialogRef"},null,512)]),c(ut,{content:s(re),"confirm-loading":s(ie),onOk:Qe},null,8,["content","confirm-loading"])],64)}}}),yo=ve(wo,[["__scopeId","data-v-c8969e72"]]),bo={class:"edit-detail"},Co={class:"bots-chat-page"},So=ge({__name:"EditDetail",setup(v){const{curBot:Z}=H(pe()),u=A();return nt("checkSettingOk",()=>u.value.handleOk(null,"模型配置已自动保存")),(O,L)=>(i(),d("div",bo,[c(Ut,{ref_key:"botDetailEditRef",ref:u},null,512),t("div",Co,[c(yo,{"bot-info":s(Z),"chat-type":"edit"},null,8,["bot-info"])])]))}}),Po=ve(So,[["__scopeId","data-v-3807c075"]]);export{Po as default};
