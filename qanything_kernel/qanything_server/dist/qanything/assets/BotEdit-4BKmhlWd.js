import{_ as q}from"./bot-avatar-CBCRm2Zm.js";import{u as h}from"./useBots-Bdp-FPKz.js";import{r as k,u as B}from"./utils-DbfuPucX.js";import{r as K}from"./router-CHst2fB9.js";import{g as N}from"./index-Cuc3aVWz.js";import{d as V,a1 as j,r as y,aT as A,am as D,a2 as _,a3 as u,M as a,e as C,a4 as n,a8 as m,F as M,a5 as O,L as P,af as L,a6 as Q,aa as G,ab as H,ac as J}from"./index-Bkza4F2y.js";import{S as U}from"./index-PNWEexSR.js";const W=c=>(G("data-v-3c28dd2f"),c=c(),H(),c),X={class:"bot-edit"},Y={key:0,class:"loading"},Z={key:1},tt={class:"header"},st={class:"name-box"},et=W(()=>n("img",{src:q,alt:"avatar"},null,-1)),ot={class:"name"},at={class:"bot-id"},nt={class:"tabs"},it=["onClick"],rt=V({__name:"BotEdit",setup(c){const{getCurrentRoute:w,changePage:p}=K(),{tabIndex:b,curBot:i}=j(h()),{setTabIndex:x,setCurBot:I,setKnowledgeList:S}=h(),f=N().bots,E=[{name:f.edit,value:0},{name:f.publish,value:1}],l=y(null),v=y(!0),T=A(P,{style:{fontSize:"48px"},spin:!0}),$=async t=>{try{let e=[...(await k(await B.kbList())).filter(s=>!/.*_FAQ$/.test(s.kb_name))];console.log("kbs",e,t),t&&t.length?e=e.map(s=>(t.some(d=>d===s.kb_id)?s.state=1:s.state=0,s)):e=e.map(s=>(s.state=0,s)),console.log("kbs2",e),S(e)}catch(o){L.error(o.msg||"获取知识库列表失败")}},z=async t=>{try{const o=await k(await B.queryBotInfo({bot_id:t}));I(o[0]),$(o[0].kb_ids),v.value=!1}catch(o){L.error(o.msg||"获取Bot信息失败")}};F();function F(){const t=w();console.log("zj-route",t),l.value=t.value.params.botId,z(l.value)}function R(t){t===1&&(!i.value.kb_ids||!i.value.kb_ids.length)||b.value!==t&&(x(t),p(t===0?`/bots/${l.value}/edit`:`/bots/${l.value}/publish`))}return(t,o)=>{var s,d;const g=U,e=D("router-view");return _(),u("div",X,[a(v)?(_(),u("div",Y,[C(g,{indicator:a(T)},null,8,["indicator"])])):(_(),u("div",Z,[n("div",tt,[n("div",st,[et,n("div",ot,m((s=a(i))==null?void 0:s.bot_name),1),n("div",at,"bot_id："+m((d=a(i))==null?void 0:d.bot_id),1)]),n("div",nt,[(_(),u(M,null,O(E,r=>n("div",{class:Q(["tab-item",a(b)===r.value?"tab-active":"",(!a(i).kb_ids||!a(i).kb_ids.length)&&r.value===1?"tab-disable":""]),key:r.name,onClick:ct=>R(r.value)},m(r.name),11,it)),64))])]),C(e)]))])}}}),ft=J(rt,[["__scopeId","data-v-3c28dd2f"]]);export{ft as default};
