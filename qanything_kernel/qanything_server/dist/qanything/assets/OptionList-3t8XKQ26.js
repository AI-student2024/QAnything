import{r as L,a8 as wt,j as de,a9 as St,aa as xt,ab as He,k as $t,ac as ut,ad as qe,d as oe,a as I,_ as ae,c,f as Q,F as le,ae as At,g as It,m as Ot,h as Pt,af as Dt,u as Lt,ag as Ft,ah as Tt,ai as Nt,n as Et,I as dt,a2 as Mt,o as Rt,$ as Wt,y as C,J as B,H as fe,x as te,w as Ne,D as n,B as p,C as x,A as O,R as Z,Z as zt,G as q,z as V,E as pt,M as jt,a4 as Xe,T as K,U as gt,aj as Ut,X as ft,Y as mt,b as vt,S as ht,ak as De,K as tt,L as Bt}from"./index-hwzCUkYO.js";import{r as re,u as ie,d as Vt,a as qt,b as Xt}from"./utils-Bqmea5t5.js";import{_ as Kt,b as Le,a as Ke,u as Fe,c as ot,p as yt}from"./useUploadFiles-DnWdxaHU.js";import{g as pe}from"./index-BQ49I3CH.js";import{i as Qe}from"./initDefaultProps-fuZk6OdZ.js";import{C as Ht}from"./index-D5Y6mJd9.js";import{d as Qt,B as Ze}from"./collapseMotion-CxgPW1EX.js";import{_ as Ee}from"./class-DD2Cp6ck.js";import{u as _t,a as Zt,b as Gt,M as Ge}from"./useChatSource-CDWNXX-8.js";import{S as Yt}from"./index-3HDOVGic.js";import{L as Jt}from"./ChatInfoPanel-__oePycC.js";import{_ as bt,a as eo}from"./index-CE5WCHUW.js";import{_ as to}from"./ActionButton-C15Z6xGq.js";const oo=()=>{const e=L(new Map),t=s=>o=>{e.value.set(s,o)};return wt(()=>{e.value=new Map}),[t,e]},so=["normal","exception","active","success"],Me=()=>({prefixCls:String,type:de(),percent:Number,format:St(),status:de(),showInfo:xt(),strokeWidth:Number,strokeLinecap:de(),strokeColor:He(),trailColor:String,width:Number,success:$t(),gapDegree:Number,gapPosition:de(),size:ut([String,Number,Array]),steps:Number,successPercent:Number,title:String,progressStatus:de()});function ce(e){return!e||e<0?0:e>100?100:e}function Te(e){let{success:t,successPercent:s}=e,o=s;return t&&"progress"in t&&(Qt(!1,"Progress","`success.progress` is deprecated. Please use `success.percent` instead."),o=t.progress),t&&"percent"in t&&(o=t.percent),o}function no(e){let{percent:t,success:s,successPercent:o}=e;const a=ce(Te({success:s,successPercent:o}));return[a,ce(ce(t)-a)]}function ao(e){let{success:t={},strokeColor:s}=e;const{strokeColor:o}=t;return[o||qe.green,s||null]}const Re=(e,t,s)=>{var o,a,m,l;let i=-1,d=-1;if(t==="step"){const P=s.steps,u=s.strokeWidth;typeof e=="string"||typeof e>"u"?(i=e==="small"?2:14,d=u??8):typeof e=="number"?[i,d]=[e,e]:[i=14,d=8]=e,i*=P}else if(t==="line"){const P=s==null?void 0:s.strokeWidth;typeof e=="string"||typeof e>"u"?d=P||(e==="small"?6:8):typeof e=="number"?[i,d]=[e,e]:[i=-1,d=8]=e}else(t==="circle"||t==="dashboard")&&(typeof e=="string"||typeof e>"u"?[i,d]=e==="small"?[60,60]:[120,120]:typeof e=="number"?[i,d]=[e,e]:(i=(a=(o=e[0])!==null&&o!==void 0?o:e[1])!==null&&a!==void 0?a:120,d=(l=(m=e[0])!==null&&m!==void 0?m:e[1])!==null&&l!==void 0?l:120));return{width:i,height:d}};var lo=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};const ro=()=>ae(ae({},Me()),{strokeColor:He(),direction:de()}),io=e=>{let t=[];return Object.keys(e).forEach(s=>{const o=parseFloat(s.replace(/%/g,""));isNaN(o)||t.push({key:o,value:e[s]})}),t=t.sort((s,o)=>s.key-o.key),t.map(s=>{let{key:o,value:a}=s;return`${a} ${o}%`}).join(", ")},co=(e,t)=>{const{from:s=qe.blue,to:o=qe.blue,direction:a=t==="rtl"?"to left":"to right"}=e,m=lo(e,["from","to","direction"]);if(Object.keys(m).length!==0){const l=io(m);return{backgroundImage:`linear-gradient(${a}, ${l})`}}return{backgroundImage:`linear-gradient(${a}, ${s}, ${o})`}},uo=oe({compatConfig:{MODE:3},name:"ProgressLine",inheritAttrs:!1,props:ro(),setup(e,t){let{slots:s,attrs:o}=t;const a=I(()=>{const{strokeColor:v,direction:b}=e;return v&&typeof v!="string"?co(v,b):{backgroundColor:v}}),m=I(()=>e.strokeLinecap==="square"||e.strokeLinecap==="butt"?0:void 0),l=I(()=>e.trailColor?{backgroundColor:e.trailColor}:void 0),i=I(()=>{var v;return(v=e.size)!==null&&v!==void 0?v:[-1,e.strokeWidth||(e.size==="small"?6:8)]}),d=I(()=>Re(i.value,"line",{strokeWidth:e.strokeWidth})),P=I(()=>{const{percent:v}=e;return ae({width:`${ce(v)}%`,height:`${d.value.height}px`,borderRadius:m.value},a.value)}),u=I(()=>Te(e)),$=I(()=>{const{success:v}=e;return{width:`${ce(u.value)}%`,height:`${d.value.height}px`,borderRadius:m.value,backgroundColor:v==null?void 0:v.strokeColor}}),f={width:d.value.width<0?"100%":d.value.width,height:`${d.value.height}px`};return()=>{var v;return c(le,null,[c("div",Q(Q({},o),{},{class:[`${e.prefixCls}-outer`,o.class],style:[o.style,f]}),[c("div",{class:`${e.prefixCls}-inner`,style:l.value},[c("div",{class:`${e.prefixCls}-bg`,style:P.value},null),u.value!==void 0?c("div",{class:`${e.prefixCls}-success-bg`,style:$.value},null):null])]),(v=s.default)===null||v===void 0?void 0:v.call(s)])}}}),po={percent:0,prefixCls:"vc-progress",strokeColor:"#2db7f5",strokeLinecap:"round",strokeWidth:1,trailColor:"#D9D9D9",trailWidth:1},go=e=>{const t=L(null);return At(()=>{const s=Date.now();let o=!1;e.value.forEach(a=>{const m=(a==null?void 0:a.$el)||a;if(!m)return;o=!0;const l=m.style;l.transitionDuration=".3s, .3s, .3s, .06s",t.value&&s-t.value<100&&(l.transitionDuration="0s, 0s")}),o&&(t.value=Date.now())}),e},fo={gapDegree:Number,gapPosition:{type:String},percent:{type:[Array,Number]},prefixCls:String,strokeColor:{type:[Object,String,Array]},strokeLinecap:{type:String},strokeWidth:Number,trailColor:String,trailWidth:Number,transition:String};var mo=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};let st=0;function nt(e){return+e.replace("%","")}function at(e){return Array.isArray(e)?e:[e]}function lt(e,t,s,o){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,m=arguments.length>5?arguments[5]:void 0;const l=50-o/2;let i=0,d=-l,P=0,u=-2*l;switch(m){case"left":i=-l,d=0,P=2*l,u=0;break;case"right":i=l,d=0,P=-2*l,u=0;break;case"bottom":d=l,u=2*l;break}const $=`M 50,50 m ${i},${d}
   a ${l},${l} 0 1 1 ${P},${-u}
   a ${l},${l} 0 1 1 ${-P},${u}`,f=Math.PI*2*l,v={stroke:s,strokeDasharray:`${t/100*(f-a)}px ${f}px`,strokeDashoffset:`-${a/2+e/100*(f-a)}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s, opacity .3s ease 0s"};return{pathString:$,pathStyle:v}}const vo=oe({compatConfig:{MODE:3},name:"VCCircle",props:Qe(fo,po),setup(e){st+=1;const t=L(st),s=I(()=>at(e.percent)),o=I(()=>at(e.strokeColor)),[a,m]=oo();go(m);const l=()=>{const{prefixCls:i,strokeWidth:d,strokeLinecap:P,gapDegree:u,gapPosition:$}=e;let f=0;return s.value.map((v,b)=>{const h=o.value[b]||o.value[o.value.length-1],M=Object.prototype.toString.call(h)==="[object Object]"?`url(#${i}-gradient-${t.value})`:"",{pathString:F,pathStyle:N}=lt(f,v,h,d,u,$);f+=v;const E={key:b,d:F,stroke:M,"stroke-linecap":P,"stroke-width":d,opacity:v===0?0:1,"fill-opacity":"0",class:`${i}-circle-path`,style:N};return c("path",Q({ref:a(b)},E),null)})};return()=>{const{prefixCls:i,strokeWidth:d,trailWidth:P,gapDegree:u,gapPosition:$,trailColor:f,strokeLinecap:v,strokeColor:b}=e,h=mo(e,["prefixCls","strokeWidth","trailWidth","gapDegree","gapPosition","trailColor","strokeLinecap","strokeColor"]),{pathString:M,pathStyle:F}=lt(0,100,f,d,u,$);delete h.percent;const N=o.value.find(T=>Object.prototype.toString.call(T)==="[object Object]"),E={d:M,stroke:f,"stroke-linecap":v,"stroke-width":P||d,"fill-opacity":"0",class:`${i}-circle-trail`,style:F};return c("svg",Q({class:`${i}-circle`,viewBox:"0 0 100 100"},h),[N&&c("defs",null,[c("linearGradient",{id:`${i}-gradient-${t.value}`,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[Object.keys(N).sort((T,X)=>nt(T)-nt(X)).map((T,X)=>c("stop",{key:X,offset:T,"stop-color":N[T]},null))])]),c("path",E,null),l().reverse()])}}}),ho=()=>ae(ae({},Me()),{strokeColor:He()}),yo=3,_o=e=>yo/e*100,bo=oe({compatConfig:{MODE:3},name:"ProgressCircle",inheritAttrs:!1,props:Qe(ho(),{trailColor:null}),setup(e,t){let{slots:s,attrs:o}=t;const a=I(()=>{var h;return(h=e.width)!==null&&h!==void 0?h:120}),m=I(()=>{var h;return(h=e.size)!==null&&h!==void 0?h:[a.value,a.value]}),l=I(()=>Re(m.value,"circle")),i=I(()=>{if(e.gapDegree||e.gapDegree===0)return e.gapDegree;if(e.type==="dashboard")return 75}),d=I(()=>({width:`${l.value.width}px`,height:`${l.value.height}px`,fontSize:`${l.value.width*.15+6}px`})),P=I(()=>{var h;return(h=e.strokeWidth)!==null&&h!==void 0?h:Math.max(_o(l.value.width),6)}),u=I(()=>e.gapPosition||e.type==="dashboard"&&"bottom"||void 0),$=I(()=>no(e)),f=I(()=>Object.prototype.toString.call(e.strokeColor)==="[object Object]"),v=I(()=>ao({success:e.success,strokeColor:e.strokeColor})),b=I(()=>({[`${e.prefixCls}-inner`]:!0,[`${e.prefixCls}-circle-gradient`]:f.value}));return()=>{var h;const M=c(vo,{percent:$.value,strokeWidth:P.value,trailWidth:P.value,strokeColor:v.value,strokeLinecap:e.strokeLinecap,trailColor:e.trailColor,prefixCls:e.prefixCls,gapDegree:i.value,gapPosition:u.value},null);return c("div",Q(Q({},o),{},{class:[b.value,o.class],style:[o.style,d.value]}),[l.value.width<=20?c(Ee,null,{default:()=>[c("span",null,[M])],title:s.default}):c(le,null,[M,(h=s.default)===null||h===void 0?void 0:h.call(s)])])}}}),ko=()=>ae(ae({},Me()),{steps:Number,strokeColor:ut(),trailColor:String}),Co=oe({compatConfig:{MODE:3},name:"Steps",props:ko(),setup(e,t){let{slots:s}=t;const o=I(()=>Math.round(e.steps*((e.percent||0)/100))),a=I(()=>{var i;return(i=e.size)!==null&&i!==void 0?i:[e.size==="small"?2:14,e.strokeWidth||8]}),m=I(()=>Re(a.value,"step",{steps:e.steps,strokeWidth:e.strokeWidth||8})),l=I(()=>{const{steps:i,strokeColor:d,trailColor:P,prefixCls:u}=e,$=[];for(let f=0;f<i;f+=1){const v=Array.isArray(d)?d[f]:d,b={[`${u}-steps-item`]:!0,[`${u}-steps-item-active`]:f<=o.value-1};$.push(c("div",{key:f,class:b,style:{backgroundColor:f<=o.value-1?v:P,width:`${m.value.width/i}px`,height:`${m.value.height}px`}},null))}return $});return()=>{var i;return c("div",{class:`${e.prefixCls}-steps-outer`},[l.value,(i=s.default)===null||i===void 0?void 0:i.call(s)])}}}),wo=new Dt("antProgressActive",{"0%":{transform:"translateX(-100%) scaleX(0)",opacity:.1},"20%":{transform:"translateX(-100%) scaleX(0)",opacity:.5},to:{transform:"translateX(0) scaleX(1)",opacity:0}}),So=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:ae(ae({},Pt(e)),{display:"inline-block","&-rtl":{direction:"rtl"},"&-line":{position:"relative",width:"100%",fontSize:e.fontSize,marginInlineEnd:e.marginXS,marginBottom:e.marginXS},[`${t}-outer`]:{display:"inline-block",width:"100%"},[`&${t}-show-info`]:{[`${t}-outer`]:{marginInlineEnd:`calc(-2em - ${e.marginXS}px)`,paddingInlineEnd:`calc(2em + ${e.paddingXS}px)`}},[`${t}-inner`]:{position:"relative",display:"inline-block",width:"100%",overflow:"hidden",verticalAlign:"middle",backgroundColor:e.progressRemainingColor,borderRadius:e.progressLineRadius},[`${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorInfo}},[`${t}-success-bg, ${t}-bg`]:{position:"relative",backgroundColor:e.colorInfo,borderRadius:e.progressLineRadius,transition:`all ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`},[`${t}-success-bg`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,backgroundColor:e.colorSuccess},[`${t}-text`]:{display:"inline-block",width:"2em",marginInlineStart:e.marginXS,color:e.progressInfoTextColor,lineHeight:1,whiteSpace:"nowrap",textAlign:"start",verticalAlign:"middle",wordBreak:"normal",[s]:{fontSize:e.fontSize}},[`&${t}-status-active`]:{[`${t}-bg::before`]:{position:"absolute",inset:0,backgroundColor:e.colorBgContainer,borderRadius:e.progressLineRadius,opacity:0,animationName:wo,animationDuration:e.progressActiveMotionDuration,animationTimingFunction:e.motionEaseOutQuint,animationIterationCount:"infinite",content:'""'}},[`&${t}-status-exception`]:{[`${t}-bg`]:{backgroundColor:e.colorError},[`${t}-text`]:{color:e.colorError}},[`&${t}-status-exception ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorError}},[`&${t}-status-success`]:{[`${t}-bg`]:{backgroundColor:e.colorSuccess},[`${t}-text`]:{color:e.colorSuccess}},[`&${t}-status-success ${t}-inner:not(${t}-circle-gradient)`]:{[`${t}-circle-path`]:{stroke:e.colorSuccess}}})}},xo=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:{[`${t}-circle-trail`]:{stroke:e.progressRemainingColor},[`&${t}-circle ${t}-inner`]:{position:"relative",lineHeight:1,backgroundColor:"transparent"},[`&${t}-circle ${t}-text`]:{position:"absolute",insetBlockStart:"50%",insetInlineStart:0,width:"100%",margin:0,padding:0,color:e.colorText,lineHeight:1,whiteSpace:"normal",textAlign:"center",transform:"translateY(-50%)",[s]:{fontSize:`${e.fontSize/e.fontSizeSM}em`}},[`${t}-circle&-status-exception`]:{[`${t}-text`]:{color:e.colorError}},[`${t}-circle&-status-success`]:{[`${t}-text`]:{color:e.colorSuccess}}},[`${t}-inline-circle`]:{lineHeight:1,[`${t}-inner`]:{verticalAlign:"bottom"}}}},$o=e=>{const{componentCls:t}=e;return{[t]:{[`${t}-steps`]:{display:"inline-block","&-outer":{display:"flex",flexDirection:"row",alignItems:"center"},"&-item":{flexShrink:0,minWidth:e.progressStepMinWidth,marginInlineEnd:e.progressStepMarginInlineEnd,backgroundColor:e.progressRemainingColor,transition:`all ${e.motionDurationSlow}`,"&-active":{backgroundColor:e.colorInfo}}}}}},Ao=e=>{const{componentCls:t,iconCls:s}=e;return{[t]:{[`${t}-small&-line, ${t}-small&-line ${t}-text ${s}`]:{fontSize:e.fontSizeSM}}}},Io=It("Progress",e=>{const t=e.marginXXS/2,s=Ot(e,{progressLineRadius:100,progressInfoTextColor:e.colorText,progressDefaultColor:e.colorInfo,progressRemainingColor:e.colorFillSecondary,progressStepMarginInlineEnd:t,progressStepMinWidth:t,progressActiveMotionDuration:"2.4s"});return[So(s),xo(s),$o(s),Ao(s)]});var Oo=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(s[o[a]]=e[o[a]]);return s};const Po=oe({compatConfig:{MODE:3},name:"AProgress",inheritAttrs:!1,props:Qe(Me(),{type:"line",percent:0,showInfo:!0,trailColor:null,size:"default",strokeLinecap:"round"}),slots:Object,setup(e,t){let{slots:s,attrs:o}=t;const{prefixCls:a,direction:m}=Lt("progress",e),[l,i]=Io(a),d=I(()=>Array.isArray(e.strokeColor)?e.strokeColor[0]:e.strokeColor),P=I(()=>{const{percent:b=0}=e,h=Te(e);return parseInt(h!==void 0?h.toString():b.toString(),10)}),u=I(()=>{const{status:b}=e;return!so.includes(b)&&P.value>=100?"success":b||"normal"}),$=I(()=>{const{type:b,showInfo:h,size:M}=e,F=a.value;return{[F]:!0,[`${F}-inline-circle`]:b==="circle"&&Re(M,"circle").width<=20,[`${F}-${b==="dashboard"&&"circle"||b}`]:!0,[`${F}-status-${u.value}`]:!0,[`${F}-show-info`]:h,[`${F}-${M}`]:M,[`${F}-rtl`]:m.value==="rtl",[i.value]:!0}}),f=I(()=>typeof e.strokeColor=="string"||Array.isArray(e.strokeColor)?e.strokeColor:void 0),v=()=>{const{showInfo:b,format:h,type:M,percent:F,title:N}=e,E=Te(e);if(!b)return null;let T;const X=h||(s==null?void 0:s.format)||(se=>`${se}%`),z=M==="line";return h||s!=null&&s.format||u.value!=="exception"&&u.value!=="success"?T=X(ce(F),ce(E)):u.value==="exception"?T=z?c(Ft,null,null):c(Tt,null,null):u.value==="success"&&(T=z?c(Nt,null,null):c(Ht,null,null)),c("span",{class:`${a.value}-text`,title:N===void 0&&typeof T=="string"?T:void 0},[T])};return()=>{const{type:b,steps:h,title:M}=e,{class:F}=o,N=Oo(o,["class"]),E=v();let T;return b==="line"?T=h?c(Co,Q(Q({},e),{},{strokeColor:f.value,prefixCls:a.value,steps:h}),{default:()=>[E]}):c(uo,Q(Q({},e),{},{strokeColor:d.value,prefixCls:a.value,direction:m.value}),{default:()=>[E]}):(b==="circle"||b==="dashboard")&&(T=c(bo,Q(Q({},e),{},{prefixCls:a.value,strokeColor:d.value,progressStatus:u.value}),{default:()=>[E]})),l(c("div",Q(Q({role:"progressbar"},N),{},{class:[$.value,F],title:M}),[T]))}}}),Do=Et(Po);var Lo={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};function rt(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),o.forEach(function(a){Fo(e,a,s[a])})}return e}function Fo(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Ye=function(t,s){var o=rt({},t,s.attrs);return c(dt,rt({},o,{icon:Lo}),null)};Ye.displayName="MinusCircleOutlined";Ye.inheritAttrs=!1;var To={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};function it(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?Object(arguments[t]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),o.forEach(function(a){No(e,a,s[a])})}return e}function No(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Je=function(t,s){var o=it({},t,s.attrs);return c(dt,it({},o,{icon:To}),null)};Je.displayName="PlusCircleOutlined";Je.inheritAttrs=!1;const Eo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAKFSURBVFiF1ZjNattAEIC/VH0Ag3O3wb0b+gKF0HMCfoAW/AAFP0ALaZ8guffQvoFzzsF5hNwLUu4F+Q2mB+1Yk9XfriTXycAiWdbufDuz2p2ZMxFJeMHy5tQAXfJ2YP8J8AGYufuZe/4E7N31wd3/N8AJ8Am4Apbud5dsgTvgV6yys8g1+AX4ZqD2wKNrajEoLbqksLBKBvyIAhWRJKC9F5FUStmJyEpEpgF9p+7dnemfisgiRHcI4FpEcgN2ETipprF0orkDHwR4bWZ9MwDMbzdm3Ou+gCszyGZEuLrJr2MBF1K6tXWGA9vG6cilWOfBgKnrOKZbu9ydhgKu2zoEtoWzTshXnkj5hVeWUh2gWq9xXQTA6Riha/fCvZ/7k/IB1Xq7EeDSCAs2WtEPFi7d9Tb8cDnIHLh31wz4SNwZrDqv7EN71E2Av+7+PHLwOrgsor/q/+Pu36l+a0E9M2OjjzHgoDzXNULCB9RQ6fEEcCqq+xAhWUAboZwCzupWY9Va8Ikw+cm4cFZ3LWCszLpfGS4WsELfIWq1OaWrh0rFixZQ/R8SwsNz184ZB7LyHdRZcBkxYMa4kKr7YEF/o65slIFi4TL6b9SVg8J3cWWjDBQLZWFjRHVuaXCx/glF9hYrGcMgVefds6deRDGVMpLumxz1CbcaY9C6eFDD8L4hl040JmDVCVVi0FcZ8idSJDDq6mNkdNo0s8ulIZFvSzt1XYgcJ7PbmPEbE/hXnbhrW0np7lT6J1OJFDuD5h55yFihxaOFjF88qk3U/RZbfvsMfPU24Afay2+2hrgHvhORlMUCWtBLvAysQfQI3QK/iay29gVUaSsBaxl4UAl4KODR5cVX+f8BBZDb8KKHVtYAAAAASUVORK5CYII=",Mo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAP5JREFUOE+tlNENgzAMRM1khY28QcsG3qgwWauz4ujiJKBKzRcY5+U421nkT2uZcVR1FZEnfT/xbGav0Z4ONADsIgIo1qM87xnYgFQVp0FFlxgqZjkVRAmbmR3YSDG8Ax5xKHyLSM1l0IeV0C/CGwCwsSothzzMbMOhDsrBEouNrK4xW1VrDoNy0hq/QmDkuIIcCxDI56y0I8UF5C0COIOqmdwn4RUrSRV0nxjUyB4l50YsSt2SAFWJk+SD/UoeuSVc/kufJgfAH2cwqGsyqkxTiOJb01e3I1I2oRV8WG9HZDBLaESf+NLZfBN0Fb66RuK6wMTHGrZI41E289f3L/XxvhPPyll2AAAAAElFTkSuQmCC",kt=Mt("useChunkView",()=>({showChunkModel:L(!1)})),Ro=oe({__name:"LoadingImg",setup(e){const t=L(),s=()=>{t.value&&t.value.classList.add("loading")},o=()=>{t.value&&t.value.classList.remove("loading")};return Rt(()=>{s()}),Wt(()=>{o()}),(a,m)=>(C(),B("img",{ref_key:"loadingRef",ref:t,class:"img",src:Kt,alt:"loading"},null,512))}}),ct=fe(Ro,[["__scopeId","data-v-e69df7ef"]]),Wo={key:0,class:"container"},zo={class:"title"},jo={class:"multi-color-progress"},Uo={class:"progress-outer"},Bo={class:"progress"},Vo={class:"percent"},qo={class:"percent-text"},Xo="#52c41a",Ko="#FFEB3B",Ho="#f5222d",Qo="#bfbfbf",Zo=oe({__name:"UploadProgress",setup(e){const{dataSource:t,totalStatus:s,kbTotal:o}=te(Le()),a=pe().progress,m=L({green:0,yellow:0,red:0,gray:0}),l=L({green:0,yellow:0,red:0,gray:0}),i=L({green:0,yellow:0,red:0,gray:0}),d=()=>{m.value=s.value;for(const $ in m.value){const f=m.value[$]/o.value*100;l.value[$]=parseFloat(f.toFixed(2))}const u=100-Object.values(l.value).reduce(($,f)=>$+f,0);u>0&&(l.value.gray+=u),i.value.green=l.value.green,i.value.red=l.value.red+i.value.green,i.value.yellow=l.value.yellow+i.value.red,i.value.gray=l.value.gray+i.value.yellow};return Ne(()=>s,()=>{d()},{immediate:!0,deep:!0}),(P,u)=>{const $=Do,f=Ee;return n(t).length!==0?(C(),B("div",Wo,[p("span",zo,x(n(a).uploadTotalProgress)+"：",1),c(f,{title:`${n(a).putStorage}: ${n(m).green},
      ${n(a).inLine}: ${n(m).gray},
      ${n(a).parsing}: ${n(m).yellow},
      ${n(a).failure}: ${n(m).red}`},{default:O(()=>[p("div",jo,[p("div",Uo,[p("div",Bo,[c($,{percent:n(i).green,class:"progress-segment green",status:"active","stroke-color":Xo},null,8,["percent"]),c($,{percent:n(i).red,class:"progress-segment red",status:"active","stroke-color":Ho},null,8,["percent"]),c($,{percent:n(i).yellow,class:"progress-segment yellow",status:"active","stroke-color":Ko},null,8,["percent"]),c($,{percent:n(i).gray,class:"progress-segment gray",status:"active","stroke-color":Qo},null,8,["percent"])])]),p("div",Vo,[p("div",qo,x((n(l).green+n(l).red).toFixed(2))+"% ",1)])])]),_:1},8,["title"])])):Z("",!0)}}}),Go=fe(Zo,[["__scopeId","data-v-742741e5"]]),Yo=e=>(ft("data-v-f053baeb"),e=e(),mt(),e),Jo={class:"container"},es={class:"scale"},ts={class:"scale-text"},os={class:"file-preview-content"},ss=Yo(()=>p("div",{class:"resize-handle"},null,-1)),ns={class:"export"},as={style:{color:"#666","user-select":"text"}},ls={class:"file-path"},rs={key:1},is=["innerHTML"],cs={key:2,class:"editable-row-operations"},us={key:0,class:"operation-div"},ds={class:"footer"},ps=oe({__name:"ChunkViewDialog",props:{kbId:{},fileId:{},fileName:{}},setup(e){const{showChunkModel:t}=te(kt()),{common:s}=pe(),{chatSettingFormActive:o}=te(_t()),{setSourceType:a,setSourceUrl:m,setTextContent:l}=Zt(),i=e,{kbId:d,fileId:P,fileName:u}=zt(i),$=L([{title:"编号",key:"id",dataIndex:"id",width:70},{title:"markdown预览",key:"content",dataIndex:"content",resizable:!0,width:150,minWidth:150},{title:"分析结果",key:"editContent",dataIndex:"editContent",resizable:!0,width:150,minWidth:150},{title:"操作",key:"operation",dataIndex:"operation",width:100}]),f=L(new Map),v=r=>{const y=r.key,S=r.content;f.value.has(y)?f.value.delete(y):f.value.set(y,S)},b=(...r)=>{r[2].map(S=>{const j=S.key,_=S.content;f.value.has(j)?f.value.delete(j):f.value.set(j,_)})},h=()=>{let r="";[...f.value.values()].map(S=>{r+=S+`

`}),M(r)},M=r=>{try{const y="output.txt",S=new File([r],y,{type:"text/plain;charset=utf-8"}),j=URL.createObjectURL(S);Vt(j,y),f.value.clear()}catch{q.error("download error")}},F=L(!1),N=L(!1),E=L({pageNum:1,pageSize:5,total:0,showSizeChanger:!1,showTotal:r=>`共 ${r} 条`}),T=r=>{E.value.pageNum=r.current,me(d.value,P.value)},X=L([]),z=L({}),se=L(1),Y=L(""),D=r=>{z.value[r]=JSON.parse(JSON.stringify(X.value.filter(y=>r===y.key)[0]))},g=async r=>{N.value=!0,q.warn("正在更新……");try{await re(await ie.updateDocCompleted({chunk_size:o.value.chunkSize,doc_id:r,update_content:z.value[r].editContent})),q.success("修改成功"),Object.assign(X.value.filter(y=>r===y.key)[0],z[r]),delete z.value[r]}catch(y){q.error(y.msg)}finally{N.value=!1}},A=r=>{delete z.value[r]},k=()=>{t.value=!1,!N&&(z.value={})},w=L(1),G=()=>{w.value+=.1},ne=()=>{w.value<=.15||(w.value-=.1)},me=async(r,y)=>{F.value=!0;try{const S=await re(await ie.getDocCompleted({kb_id:r,file_id:y,page_id:E.value.pageNum,page_limit:E.value.pageSize}));se.value=(E.value.pageNum-1)*E.value.pageSize+1,E.value.total=S.total_count,X.value=[],Y.value=S.file_path,S.chunks.forEach(j=>{X.value.push({key:j.chunk_id,id:se.value++,content:j.page_content,editContent:j.page_content})})}catch(S){q.error(S.msg||"获取文档解析结果失败")}finally{F.value=!1}};Ne(()=>t.value,()=>{t.value?(X.value=[],me(d.value,P.value),he({file_id:P.value,file_name:u.value})):t.value||(w.value=1,X.value=[],se.value=1,E.value.pageNum=1,E.value.total=1,m(""),l(""),f.value.clear())});let ve=["pdf","docx","xlsx","txt","md","jpg","png","jpeg","csv","eml"];const We=r=>{if(!r)return!1;const y=r.split(".");if(y.length){const S=y.pop();return!!ve.includes(S)}else return!1},he=r=>{We(r.file_name)&&ze(r)};async function ze(r){try{m(null);const y=await re(await ie.getFile({file_id:r.file_id})),S=r.file_name.split(".").pop(),j=_e(S);if(console.log("b64Type",j),a(S),m(`data:${j};base64,${y.file_base64}`),S==="txt"||S==="md"||S==="csv"||S==="eml"){const _=atob(y.file_base64),R=decodeURIComponent(escape(_));l(R)}}catch(y){q.error(y.msg||"获取文件失败")}}let ye=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/markdown","image/jpeg","image/png","image/jpeg","text/csv","message/rfc822","application/vnd.openxmlformats-officedocument.presentationml.presentation"];function _e(r){const y=ve.indexOf(r);return ye[y]}const je=r=>r.replace(/\n/g,"<br />"),be=L(null),ke=()=>be.value.clientWidth,Ce=L(0),we=()=>{const j=document.querySelector(".chunk-table").querySelector('.ant-table-cell[colstart="3"]').clientWidth;return console.log("----",j),j>150},Ue=(r,y)=>{Ce.value=ke(),console.log(Ce.value),console.log(we()),console.log(r,y.width);const S=r<y.width?"left":"right";(we()||S==="left")&&(y.width=r)},ue=L(!1),Se=L(0),xe=L(0),$e=L("40%"),Be=r=>{r>={min:300}.min&&($e.value=`${r}px`)},Ve=r=>{console.log(r.target.classList),r.target.classList.contains("resize-handle")&&(ue.value=!0,Se.value=r.clientX,xe.value=r.target.parentElement.offsetWidth,window.addEventListener("mousemove",Ae),window.addEventListener("mouseup",Ie))},Ae=r=>{if(ue.value){const y=r.clientX-Se.value,S=xe.value+y;Be(S)}},Ie=()=>{ue.value&&(ue.value=!1,window.removeEventListener("mousemove",Ae),window.removeEventListener("mouseup",Ie))};return(r,y)=>{const S=Ze,j=Ee,_=to,R=Jt,J=bt,Oe=Ge,Pe=Ut;return C(),V(gt,{to:"body"},[c(Pe,{theme:{token:{colorPrimary:"#5a47e5"}}},{default:O(()=>[c(Oe,{open:n(t),"onUpdate:open":y[0]||(y[0]=ee=>pt(t)?t.value=ee:null),title:"切片分析结果",centered:"",width:"100%","wrap-class-name":"chunk-modal","destroy-on-close":"",footer:null,onCancel:k},{default:O(()=>[p("div",Jo,[p("div",{class:"file-preview",style:jt({width:n($e)}),onMousedown:Ve},[p("div",es,[c(S,{shape:"circle",icon:Xe(n(Je)),onClick:G},null,8,["icon"]),p("span",ts,x((n(w)*100).toFixed(0))+"%",1),c(S,{shape:"circle",icon:Xe(n(Ye)),onClick:ne},null,8,["icon"])]),p("div",os,[c(Yt,{"zoom-level":n(w)},null,8,["zoom-level"])]),ss],36),p("div",{ref_key:"tableDomRef",ref:be,class:"chunk-table"},[p("div",ns,[c(j,{color:"#fff",placement:"bottom"},{title:O(()=>[p("span",as,x(n(Y)),1)]),default:O(()=>[p("span",ls,"文件与解析结果所在目录: "+x(n(Y)),1)]),_:1}),c(S,{type:"primary",onClick:h},{default:O(()=>[K(" 导出选中("+x(n(f).size)+") ",1)]),_:1})]),c(J,{columns:n($),"data-source":n(X),bordered:"",scroll:{y:"calc(100vh - 32px - 40px - 42px - 64px - 56px - 42px - 48px)"},pagination:n(E),loading:n(F),"row-selection":{selectedRowKeys:[...n(f).keys()],onSelect:v,onSelectAll:b},onChange:T,onResizeColumn:Ue},{bodyCell:O(({column:ee,record:H})=>[ee.dataIndex==="content"?(C(),V(Gt,{key:0,content:n(z)[H.key]?n(z)[H.key].editContent:H.content},null,8,["content"])):Z("",!0),ee.dataIndex==="editContent"?(C(),B("div",rs,[n(z)[H.key]?(C(),V(_,{key:0,value:n(z)[H.key][ee.dataIndex],"onUpdate:value":U=>n(z)[H.key][ee.dataIndex]=U,style:{margin:"-5px 0"},"show-count":"","auto-size":""},null,8,["value","onUpdate:value"])):(C(),B("div",{key:1,innerHTML:je(H.content)},null,8,is))])):ee.dataIndex==="operation"?(C(),B("div",cs,[n(z)[H.key]?(C(),B("div",us,[c(S,{class:"operation-btn",size:"small",loading:n(N),type:"link",onClick:U=>g(H.key)},{default:O(()=>[K(x(n(N)?"":n(s).save),1)]),_:2},1032,["loading","onClick"]),n(N)?Z("",!0):(C(),V(S,{key:0,class:"operation-btn",size:"small",loading:n(N),type:"text",onClick:U=>A(H.key)},{default:O(()=>[K(x(n(s).cancel),1)]),_:2},1032,["loading","onClick"]))])):(C(),V(R,{key:1,onClick:U=>D(H.key)},{default:O(()=>[K(x(n(s).edit),1)]),_:2},1032,["onClick"]))])):Z("",!0)]),_:1},8,["columns","data-source","scroll","pagination","loading","row-selection"])],512)]),p("div",ds,[c(S,{type:"primary",onClick:k},{default:O(()=>[K(x(n(s).close),1)]),_:1})])]),_:1},8,["open"])]),_:1})])}}}),gs=fe(ps,[["__scopeId","data-v-f053baeb"]]),fs={class:"file"},ms={class:"box"},vs={class:"before-upload-box"},hs=["accept"],ys={class:"before-upload"},_s={class:"upload-text-box"},bs={class:"upload-text"},ks={class:"blue"},Cs={class:"desc"},ws=125*1024*1024,Ss=oe({__name:"FileUploadDialog",props:{dialogType:{type:Number,require:!0,default:0}},setup(e){const t=pe().common,{setKnowledgeName:s,setModalVisible:o}=Ke(),{setDefault:a}=Fe(),{getDetails:m}=Le(),{modalVisible:l,modalTitle:i}=te(Ke()),{currentId:d,currentKbName:P}=te(Fe()),{uploadFileList:u,uploadFileListQuick:$}=te(ot()),{initUploadFileList:f}=ot(),{chatSettingFormActive:v}=te(_t()),b=e,h=L(),M=I(()=>d.value.length>0&&u.value.length>0&&u.value.every(D=>D.status!="loading"));Ne(()=>l.value,()=>{s(P.value),b.dialogType===1&&(u.value=$.value),!l.value&&b.dialogType===0&&f()});const F=[".md",".txt",".pdf",".jpg",".png",".jpeg",".docx",".xlsx",".pptx",".eml",".csv"],N={document:30*1024*1024,image:5*1024*1024},E=async(D,g)=>new Promise((A,k)=>{if(console.log(D),D.name&&F.includes("."+D.name.split(".").pop().toLowerCase())){const w=D.type.startsWith("image/")?N.image:N.document,G=D.type.startsWith("image/")?"图片":"文档";if(D.size>w){k(`单个${G}太大，不能超过 ${w/1024/1024} MB`);return}u.value.push({file_name:D.name,file:D,status:"loading",text:t.uploading,file_id:"",order:u.value.length,bytes:0}),A(g)}else k(`${D.name}的文件格式不符`)}),T=D=>{const g=D.target.files;let A=0;Array.from(g).forEach(k=>{if(A+=k.size,A>=ws){q.error("文件总大小超过125MB");return}}),Array.from(g).forEach(async(k,w)=>{try{await E(k,w)}catch(G){q.error(G)}}),setTimeout(()=>{u.value.length&&X()})},X=async()=>{var A;Y();const D=[];u.value.forEach(k=>{k.status=="loading"&&D.push(k)});const g=new FormData;for(let k=0;k<D.length;k++)g.append("files",(A=D[k])==null?void 0:A.file);g.append("kb_id",d.value),g.append("user_id",qt),g.append("chunk_size",v.value.chunkSize.toString()),g.append("mode","soft"),z(0),fetch(Xt+"/local_doc_qa/upload_files",{method:"POST",body:g}).then(k=>{if(k.ok)return k.json();throw new Error("上传失败")}).then(k=>{if(k.code===200){if(k.data.length===0){q.warn(k.msg||"出错了"),De.close("upload"),b.dialogType===1&&D.forEach(w=>{u.value[w.order].status="error",u.value[w.order].errorText=(k==null?void 0:k.msg)||t.upFailed});return}z(1),b.dialogType===1&&D.forEach((w,G)=>{let ne=k.data[G].status;ne=="green"||ne=="gray"?ne="success":ne="error",u.value[w.order].status=ne,u.value[w.order].file_id=k.data[G].file_id,u.value[w.order].bytes=k.data[G].bytes,u.value[w.order].errorText=t.upSucceeded})}else q.error(k.msg||"出错了"),De.close("upload"),D.forEach(w=>{u.value[w.order].status="error",u.value[w.order].errorText=(k==null?void 0:k.msg)||t.upFailed})}).catch(k=>{q.error(k.msg||"出错了"),De.close("upload")}).finally(()=>{m()})},z=D=>{De[D?"success":"info"]({key:"upload",message:D?"上传完成":"上传中",description:D?"":"最多需要30s",duration:D?2.5:0})},se=async()=>{o(!1),a(yt.optionlist),await m()},Y=()=>{o(!1)};return vt(()=>{h.value&&clearTimeout(h.value)}),(D,g)=>{const A=Ze,k=Ge;return C(),V(gt,{to:"body"},[c(k,{open:n(l),"onUpdate:open":g[1]||(g[1]=w=>pt(l)?l.value=w:null),title:n(i),centered:"",width:"480px","wrap-class-name":"upload-file-modal","destroy-on-close":""},{footer:O(()=>[b.dialogType===0?(C(),V(A,{key:"submit",type:"primary",class:"upload-btn",disabled:!n(M),onClick:se},{default:O(()=>[K(x(n(t).confirm),1)]),_:1},8,["disabled"])):Z("",!0),b.dialogType===1?(C(),V(A,{key:"submit",type:"primary",class:"upload-btn",onClick:Y},{default:O(()=>[K(x(n(t).cancel),1)]),_:1})):Z("",!0)]),default:O(()=>[p("div",fs,[p("div",ms,[p("div",vs,[p("input",{class:"hide input",type:"file",accept:F.join(","),multiple:"",onChange:T,onClick:g[0]||(g[0]=w=>w.target.value="")},null,40,hs),p("div",ys,[p("div",_s,[c(ht,{name:"upload"}),p("p",null,[p("span",bs,[K(x(n(t).dragUrl)+" ",1),p("span",ks,x(n(t).click),1)])])]),p("p",Cs,x(n(t).updesc1),1)])])])])]),_:1},8,["open","title"])])}}}),xs=fe(Ss,[["__scopeId","data-v-14f8a744"]]),Ct=e=>(ft("data-v-46e023db"),e=e(),mt(),e),$s={class:"list-page"},As={class:"content"},Is={class:"options"},Os=Ct(()=>p("img",{src:Eo,alt:"back"},null,-1)),Ps={class:"kb-name"},Ds={class:"name"},Ls={class:"id"},Fs={class:"nav-info"},Ts={class:"navs"},Ns=["onClick"],Es={key:0,class:"nav-progress"},Ms={class:"handle-btn"},Rs={class:"table"},Ws=Ct(()=>p("img",{src:Mo,style:{width:"18px","margin-left":"5px"},alt:"©"},null,-1)),zs={style:{color:"#666","user-select":"text"}},js={key:1,class:"status-box"},Us={class:"icon-file-status"},Bs={key:0},Vs={key:1},qs={key:0,class:"status-box"},Xs={class:"icon-file-status"},Ks={key:1,class:"options"},Hs=oe({__name:"OptionList",setup(e){const{setDefault:t}=Fe(),{currentKbName:s,currentId:o}=te(Fe()),{setModalVisible:a,setUrlModalVisible:m,setModalTitle:l}=Ke(),{showChunkModel:i}=te(kt()),{getDetails:d,setEditQaSet:P,setEditModalVisible:u,getFaqList:$,setFaqType:f,setPageNum:v,setKbPageNum:b}=Le(),{dataSource:h,faqList:M,timer:F,faqTimer:N,total:E,pageNum:T,pageSize:X,loading:z,kbTotal:se,kbPageNum:Y,kbPageSize:D}=te(Le()),g=pe().home,A=pe().common,k=pe().bots,w=L(0),G=[{name:g.docSet,value:0},{name:g.qaSet,value:1}],ne=[{title:g.documentId,dataIndex:"fileId",key:"fileId",width:"11%"},{title:g.documentName,dataIndex:"fileIdName",key:"fileIdName",width:"20%",ellipsis:!0},{title:g.documentStatus,dataIndex:"status",key:"status",width:"15%",ellipsis:!0},{title:g.fileSize,dataIndex:"bytes",key:"bytes",width:"10%"},{title:g.contentLength,dataIndex:"contentLength",key:"contentLength",width:"10%"},{title:g.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:g.remark,dataIndex:"remark",key:"remark",width:"15%"},{title:g.operate,key:"options",width:"10%"}],me=[{title:"ID",dataIndex:"id",key:"id",width:"8%"},{title:g.question,dataIndex:"question",key:"question",width:"43%",ellipsis:!0},{title:g.status,dataIndex:"status",key:"status",width:"10%",ellipsis:!0},{title:g.characterCount,dataIndex:"bytes",key:"bytes",width:"10%"},{title:g.creationDate,dataIndex:"createtime",key:"createtime",width:"11%"},{title:g.operate,key:"options",width:"10%"}],ve=I(()=>({current:Y.value,pageSize:D.value,total:se.value,showSizeChanger:!1,showTotal:_=>`共 ${_} 条`})),We=I(()=>({current:T.value,pageSize:X.value,total:E.value,showSizeChanger:!1,showTotal:_=>`共 ${_} 条`}));let he={};const ze=_=>{he=_},ye=L(""),_e=L(""),je=async _=>{ye.value=_.fileId,_e.value=_.fileIdName,i.value=!0},be=async()=>{try{await re(await ie.deleteFile({file_ids:[he.fileId],kb_id:o.value})),q.success("删除成功"),await d(),Y.value!==1&&h.value.length===0&&(Y.value-=1,await d())}catch(_){q.error(_.msg||"删除失败")}};let ke={};const Ce=_=>{ke=_},we=async()=>{try{await re(await ie.deleteFile({kb_id:`${o.value}_FAQ`,file_ids:[ke.faqId]})),q.success("删除成功"),await $(),T.value!==1&&M.value.length===0&&(T.value-=1,await $())}catch(_){q.error(_.msg||"删除失败")}},Ue=_=>{f("edit"),P(_),u(!0)},ue=()=>{t(yt.normal)},Se=()=>{a(!0),l(g.upload)},xe=()=>{m(!0),l(A.addUrl)},$e=()=>{f("upload"),u(!0)},Be=()=>{Ge.confirm({title:g.clearAllFile,content:Xe("p",g.clearAllFileConfirm),centered:!0,maskClosable:!0,okText:A.confirm,okType:"danger",async onOk(){try{await re(await ie.clearUpload({status:"gray",kb_ids:[]})),q.success("操作成功"),d()}catch(_){q.error(_.msg||"操作失败")}}})},Ve=_=>{let R;switch(_){case"gray":R=A.inLine;break;case"yellow":R=A.parsing;break;case"green":R=A.succeeded;break;default:R=A.failed;break}return R},Ae=_=>{let R=A.failed;switch(_){case"gray":R=A.uploadCompleted;break;case"yellow":R=A.inLine;break;case"green":R=A.learningCompleted;break}return R},Ie=async()=>{try{if((await re(await ie.kbList())).find(R=>R.kb_id===`${o.value}_FAQ`))return!0}catch(_){return q.error(_.msg||A.error),!0}return!1},r=async()=>{if(!await Ie()){try{await re(await ie.createKb({kb_name:`${s.value}_FAQ`,kb_id:`${o.value}_FAQ`}))}catch(R){return q.error(R.msg||A.error),!1}return!0}},y=_=>{w.value=_,_===0?(b(1),clearTimeout(N.value),d()):(v(1),clearTimeout(F.value),$(),r())},S=_=>{const{current:R}=_;v(R),$()},j=_=>{b(_.current),d()};return Ne(o,()=>{w.value=0,b(1),v(1),d()},{immediate:!0}),vt(()=>{clearTimeout(F.value),clearTimeout(N.value),b(1),v(1)}),(_,R)=>{const J=Ze,Oe=Ee,Pe=ht,ee=eo,H=bt;return C(),B(le,null,[p("div",$s,[p("div",As,[p("div",Is,[p("div",{class:"to-chat",onClick:ue},[Os,p("span",null,x(n(g).conversation),1)]),p("p",Ps,[p("span",Ds,x(n(s).slice(0,15)),1),p("span",Ls,x(n(g).knowledgeID)+" "+x(n(o))+x(n(w)===1?"_FAQ":""),1)])]),p("div",Fs,[p("div",Ts,[(C(),B(le,null,tt(G,U=>p("div",{key:U.name,class:Bt(["nav-item",n(w)===U.value?"nav-item-active":""]),onClick:W=>y(U.value)},x(U.name),11,Ns)),64))]),n(w)===0?(C(),B("div",Es,[c(Go,{"data-source":n(h)},null,8,["data-source"])])):Z("",!0),p("div",Ms,[n(w)===0?(C(),V(J,{key:0,danger:"",class:"clear-upload",onClick:Be},{default:O(()=>[K(x(n(g).clearAllFile),1)]),_:1})):Z("",!0),n(w)===0?(C(),V(J,{key:1,class:"upload",onClick:Se},{default:O(()=>[K(x(n(g).upload),1)]),_:1})):Z("",!0),n(w)===0?(C(),V(J,{key:2,class:"add-link",onClick:xe},{default:O(()=>[K(x(n(g).addUrl),1)]),_:1})):Z("",!0),n(w)===1?(C(),V(J,{key:3,class:"upload",onClick:$e},{default:O(()=>[K(x(n(g).inputQa),1)]),_:1})):Z("",!0)])]),p("div",Rs,[n(w)===0?(C(),V(H,{key:0,"data-source":n(h),columns:ne,pagination:n(ve),locale:{emptyText:n(g).emptyText},"hide-on-single-page":!0,"show-size-changer":!1,onChange:j},{headerCell:O(({column:U})=>[U.key==="status"?(C(),B(le,{key:0},[p("span",null,x(n(g).documentStatus),1),c(Oe,{color:"#5a47e5"},{title:O(()=>[K(x(n(g).documentStatusNode),1)]),default:O(()=>[Ws]),_:1})],64)):Z("",!0)]),bodyCell:O(({column:U,record:W})=>[U.key==="fileIdName"?(C(),V(Oe,{key:0,color:"#fff"},{title:O(()=>[p("span",zs,x(W.fileIdName),1)]),default:O(()=>[p("span",null,x(W.fileIdName),1)]),_:2},1024)):U.key==="status"?(C(),B("div",js,[p("span",Us,[W.status==="gray"||W.status==="yellow"?(C(),V(ct,{key:0,class:"file-status"})):(C(),V(Pe,{key:1,class:"file-status",name:W.status==="green"?"success":"error"},null,8,["name"]))]),p("span",null,x(Ve(W.status)),1)])):U.key==="remark"?(C(),B(le,{key:2},[typeof W.remark=="string"?(C(),B("div",Bs,x(W.remark),1)):(C(),B("div",Vs,[(C(!0),B(le,null,tt(W.remark,(ge,et)=>(C(),B("p",{key:et},x(`${et}: ${ge}`),1))),128))]))],64)):U.key==="options"?(C(),B(le,{key:3},[c(ee,{"overlay-class-name":"del-pop",placement:"topRight",title:n(A).deleteTitle,"ok-text":n(A).confirm,"cancel-text":n(A).cancel,onConfirm:be},{default:O(()=>[c(J,{type:"text",class:"delete-item",onClick:ge=>ze(W)},{default:O(()=>[K(x(n(A).delete),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","ok-text","cancel-text"]),c(J,{type:"text",class:"view-item",disabled:W.status!=="green",onClick:ge=>je(W)},{default:O(()=>[K(x(n(A).view),1)]),_:2},1032,["disabled","onClick"])],64)):Z("",!0)]),_:1},8,["data-source","pagination","locale"])):(C(),V(H,{key:1,"data-source":n(M),columns:me,locale:{emptyText:n(g).emptyText},loading:n(z),pagination:n(We),onChange:S},{bodyCell:O(({column:U,record:W})=>[U.key==="status"?(C(),B("div",qs,[p("span",Xs,[W.status==="gray"||W.status==="yellow"?(C(),V(ct,{key:0,class:"file-status"})):(C(),V(Pe,{key:1,class:"file-status",name:W.status==="green"?"success":"error"},null,8,["name"]))]),p("span",null,x(Ae(W.status)),1)])):U.key==="options"?(C(),B("div",Ks,[c(J,{class:"edit-item",type:"link",disabled:W.status!=="green",onClick:ge=>Ue(W)},{default:O(()=>[K(x(n(k).edit),1)]),_:2},1032,["disabled","onClick"]),c(ee,{"overlay-class-name":"qa-del-pop",placement:"topRight",title:n(g).deleteQaSetText,"ok-text":n(A).confirm,"cancel-text":n(A).cancel,onConfirm:we},{default:O(()=>[c(J,{class:"delete-item",danger:"",type:"link",onClick:ge=>Ce(W)},{default:O(()=>[K(x(n(A).delete),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","ok-text","cancel-text"])])):Z("",!0)]),_:1},8,["data-source","locale","loading","pagination"]))])])]),c(gs,{"kb-id":n(o),"file-id":n(ye),"file-name":n(_e)},null,8,["kb-id","file-id","file-name"]),c(xs,{"dialog-type":0})],64)}}}),cn=fe(Hs,[["__scopeId","data-v-46e023db"]]);export{xs as F,ct as L,cn as O,Do as _};
