import{a as $e,u as te,p as ie}from"./useUploadFiles-CYHXvtFa.js";import{g as de,u as ut}from"./index-CXmHDMVd.js";import{d as se,y as _,J as m,B as o,C as y,D as s,X as he,Y as pe,H as oe,r as I,c as p,G as D,a2 as dt,x as Q,L as R,S as L,T as Z,F as ee,K as me,R as M,a0 as z,a as ht,o as Ee,b as pt,z as re,N as j,O as K,A as T,a3 as vt,M as ge,E as _t}from"./index-vLLWhXaM.js";import{u as ye,r as Oe,a as ft,b as gt,C as mt}from"./utils-DMQccJQa.js";import{u as yt,a as bt,b as Te,D as kt,f as Ct,h as wt,_ as St,c as It,T as Dt}from"./html2canvas.esm-DVFZ3d3A.js";import{_ as At,O as Lt}from"./OptionList-COTC0YST.js";import{u as xt,_ as Be}from"./useChatSource-DtDJ0b1m.js";import{C as qt,a as $t}from"./ChatInfoPanel-76xncpRm.js";import{u as Ot}from"./useChatSetting-CWifA4XP.js";import{B as Tt}from"./RightOutlined-DYvilZv7.js";import{_ as Bt}from"./ActionButton-Cu6LdVgt.js";import{_ as Et}from"./index-BFcUdsh2.js";import"./initDefaultProps-zQa7oZMX.js";import"./index-BIwI-sY_.js";import"./index-BVuDUlPp.js";import"./slide-DOGE1U_k.js";import"./index-DcZAhTYb.js";import"./index-CqXUMj2z.js";import"./class-DeKWk5pD.js";import"./index-C9xJiak7.js";import"./responsiveObserve-DS4BXwCA.js";import"./index-RHAW8zzD.js";import"./collapseMotion-D8hX_AOB.js";import"./injectionKey-DGYNie3Z.js";const Ht="/qanything/assets/icon-file-Bxz0aRpP.png",Ft=v=>(he("data-v-ec2d7664"),v=v(),pe(),v),Qt={class:"upload-box"},Rt=Ft(()=>o("img",{class:"icon-file",src:Ht,alt:"图标"},null,-1)),Nt={class:"title"},Pt={class:"desc-content"},Ut={class:"desc"},jt={class:"desc"},Kt=se({__name:"UploadDom",props:{acceptList:{require:!0,type:Array,default:()=>[]}},emits:["update"],setup(v,{emit:u}){const i=de().home,g=u,w=()=>{g("update")};return(c,b)=>(_(),m("div",Qt,[o("div",{class:"tips",onClick:w},[Rt,o("p",Nt,y(s(i).startDec),1),o("div",Pt,[o("p",Ut,y(s(i).updesc2),1),o("p",jt,y(s(i).require1),1)])])]))}}),zt=oe(Kt,[["__scopeId","data-v-ec2d7664"]]),Mt=v=>(he("data-v-387b8125"),v=v(),pe(),v),Vt={class:"default"},Yt={class:"box"},Jt={class:"title"},Xt=Mt(()=>o("span",null," ",-1)),Zt={class:"color"},Wt={class:"desc"},Gt=se({__name:"Defaultpage",setup(v){const u=de().home,{setFileList:i}=$e(),{setModalVisible:g}=$e(),{setCurrentId:w,getList:c,setCurrentKbName:b}=te(),x=[".doc",".docx",".ppt",".pptx",".xls",".xlsx",".pdf",".md",".jpg",".jpeg",".png",".txt",".eml"],N=I(""),P=async()=>{console.log("updata");try{const d=await ye.createKb({kb_name:u.defaultName});+d.code==200&&(N.value=d.data.kb_id,w(d.data.kb_id),b(d.kb_name),g(!0),c())}catch(d){i([]),D.error(d.msg)}};return(d,U)=>(_(),m("div",Vt,[o("div",Yt,[o("p",Jt,[o("span",null,y(s(u).homeTitle1),1),Xt,o("span",Zt,y(s(u).homeTitle2),1)]),o("p",Wt,y(s(u).defaultDec),1),p(zt,{"accept-list":x,onUpdate:P})])]))}}),es=oe(Gt,[["__scopeId","data-v-387b8125"]]),ts="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAEgSURBVFiF7ZaxDcJADEVt0lAyQkaAKzIHI0BxkmeKCxiFAaKDDRAdJQvkQpNIEeQu9gVoyK8SXZz/ZPssA8ya9e/KYofW2nVRFMuqqh4pP5fEL0IHRJQj4tl7f7XW7hLMd734tRqgrutV94yIBw1Ea37o3rMsC2YgWALn3N0Yc0PEbQuxNcbcnHMXjXnTNPuyLE9qgBbiooEYMmfmY8wjCqCBSDEXAUggUs0BAFDyUachoxYoyVwNMATRl9YcQFiCvl7LMcUcIDIHfiV1BkIlkM6Jt7gp5p9oQnEGQldNO6ySAMbu+RSIUQDpkEmFGNsHVBMuBSLYhESUe++vUvMR8A0zD0KI9gFtZzPzsbshAPF9ICoiymPbzLfjZ836Dz0BusANDR+zFvgAAAAASUVORK5CYII=",ue=dt("useHomeChat",()=>{const v=I([]),u=h=>{v.value=h},i=I([]),g=h=>{i.value=h},w=h=>{var a;const k=(((a=i.value.at(-1))==null?void 0:a.historyId)||0)+1,f={historyId:k,title:h},A=[...i.value,f];return g(A),k},c=h=>{const k=i.value.filter(f=>f.historyId!==h);g(k)},b=(h,k,f)=>{const A=i.value.map(a=>(a.historyId===k&&(a.title=h,a.kbIds=f),a));g(A)},x=I([]),N=(h,k)=>{const f={historyId:h,list:k};x.value.some(a=>a.historyId===h)?x.value.forEach(a=>{a.historyId===h&&(a.list=k)}):x.value.push(f)},P=h=>x.value.filter(k=>k.historyId===h)[0],d=h=>{x.value=x.value.filter(k=>k.historyId!==h),i.value=i.value.filter(k=>k.historyId!==h)},U=I(null),q=h=>{U.value=h},V=I(1),E=h=>{V.value=h},Y=I(1);return{QA_List:v,setQaList:u,historyList:i,addHistoryList:w,deleteHistoryList:c,updateHistoryList:b,chatList:x,addChatList:N,getChatById:P,clearChatList:d,chatId:U,setChatId:q,pageId:V,setPageId:E,qaPageId:Y,setQaPageId:h=>{Y.value=h}}},{persist:{storage:localStorage}}),ss=v=>(he("data-v-b9aad642"),v=v(),pe(),v),os={class:"history-chat"},as={class:"history-chat-content"},ns={class:"list"},ls=ss(()=>o("div",{class:"line"},null,-1)),cs=["onClick"],is=["onClick"],rs=se({__name:"HistoryChat",props:{observer:{type:Object,required:!0},observeDom:{type:Object,default:null},qaObserver:{type:Object,required:!0},qaObserveDom:{type:Object,default:null},showLoading:{type:Boolean,require:!0}},emits:["scrollBottom","setObserveDom","setQaObserverDom","clearHistory"],setup(v,{emit:u}){const i=v,{chatList:g,chatId:w,QA_List:c,qaPageId:b,pageId:x,historyList:N}=Q(ue()),{deleteHistoryList:P,getChatById:d}=ue(),{setSelectList:U}=te(),q=u;function V(f){c.value.push({question:f,type:"user"})}function E(f,A,a,W,S,O){c.value.push({answer:a,question:f,itemInfo:A,type:"ai",qaId:S,copied:!1,like:!1,unlike:!1,source:O||[],showTools:!0,picList:W})}async function Y(f){if(!i.showLoading){w.value=f.historyId,c.value=[],b.value=1,U([...f.kbIds]),q("clearHistory");try{const A=d(w.value);i.qaObserveDom!==null&&(i.qaObserver.unobserve(i.qaObserveDom),q("setQaObserverDom",null)),A.list.forEach(a=>{a.type==="user"?V(a.question):a.type==="ai"&&E(a.question,a.itemInfo,a.answer,a.picList,a.qaId,a.source)}),q("scrollBottom"),A.list.length>=50&&await z(()=>{const a=document.getElementsByClassName("chat-li");a.length&&(i.qaObserver.observe(a[0]),q("setQaObserverDom",a[0]))})}catch(A){D.error(A.msg||"获取问答历史失败")}}}function J(){if(!i.showLoading){if(w.value===null){D.info("已切换最新对话");return}w.value=null,c.value=[],b.value=1,x.value=1,q("clearHistory")}}async function h(f,A){if(!i.showLoading)try{P(f.historyId),f.historyId===w.value&&J(),D.success("删除成功"),g.value.splice(A,1),await z(()=>{k()})}catch(a){D.error(a.msg||"删除失败")}}function k(){if(i.qaObserveDom!==null){i.qaObserver.unobserve(i.qaObserveDom),q("setQaObserverDom",null);const f=document.getElementsByClassName("chat-li");f.length&&(i.qaObserver.observe(f[0]),q("setQaObserverDom",f[0]))}}return(f,A)=>(_(),m("div",os,[o("div",as,[o("div",ns,[o("div",{class:R(["new-chat",[v.showLoading?"disabled":"",s(w)===null?"new-active":""]]),onClick:J},[p(L,{name:"new-chat"}),Z(" "+y(s(de)().home.newConversation),1)],2),(_(!0),m(ee,null,me(s(N),(a,W)=>(_(),m("div",{key:a.historyId,class:R(["chat-item",s(w)===a.historyId?"item-active":"",v.showLoading?"disabled":""])},[ls,o("span",{onClick:S=>Y(a)},y(a.title),9,cs),s(w)===a.historyId?(_(),m("img",{key:0,src:ts,class:"close-icon",alt:"close",onClick:S=>h(a,W)},null,8,is)):M("",!0)],2))),128))])])]))}}),us=oe(rs,[["__scopeId","data-v-b9aad642"]]),He=v=>(he("data-v-ed5d54b1"),v=v(),pe(),v),ds={class:"container showSider"},hs={class:"my-page"},ps={key:0,class:"user"},vs=He(()=>o("img",{class:"avatar",src:St,alt:"头像"},null,-1)),_s={class:"question-text"},fs={key:1,class:"ai"},gs=He(()=>o("img",{class:"avatar",src:It,alt:"头像"},null,-1)),ms={class:"ai-content"},ys={class:"ai-right"},bs={key:0},ks={key:1},Cs={class:"source-list"},ws={class:"control"},Ss={class:"tips"},Is=["href"],Ds=["onClick"],As={class:"source-content"},Ls={class:"score"},xs={class:"tips"},qs={key:1,class:"feed-back"},$s=["onClick"],Os={class:"reload-text"},Ts={class:"tools"},Bs={key:0,class:"stop-btn"},Es={class:"question-box"},Hs={class:"question"},Fs={class:"send-box"},Qs={class:"send-action"},Rs=se({__name:"Chat",setup(v){const u=de().common,i=new Dt(e=>{e&&(c.value[c.value.length-1].answer+=e||"")}),{selectList:g,knowledgeBaseList:w}=Q(te()),{QA_List:c,chatId:b,pageId:x,qaPageId:N,historyList:P}=Q(ue()),{chatSettingFormActive:d}=Q(Ot()),{copy:U}=yt(),{addHistoryList:q,updateHistoryList:V,addChatList:E,clearChatList:Y}=ue(),{setChatSourceVisible:J,setSourceType:h,setSourceUrl:k,setTextContent:f}=xt(),{language:A}=Q(ut()),a=I(""),W=ht(()=>{const e=d.value.context;if(e===0)return[];const t=c.value.filter(l=>l.type==="ai");return(e===11?t:t.slice(-e)).map(l=>[l.question,l.answer])}),S=I(!1),O=I([]),ae=I(null),ne=I(null);let B;const Fe=I(null),be=I(null),H=()=>{z(()=>{z(()=>{var e;(e=be.value)==null||e.scrollIntoView({behavior:"smooth",block:"end"})})})},ke=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(console.log("entry.isIntersecting"),x.value++)})}),Ce=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(console.log("qa entry.isIntersecting"),N.value++)})});Ee(()=>{H()}),pt(()=>{ae.value&&ke.unobserve(ae.value),ne.value&&Ce.unobserve(ne.value)});const Qe=e=>{e.keyCode===13&&(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey?a.value+=`
`:ve(),e.preventDefault())},Re=bt((e,t)=>{if(e.like=!e.like,e.unlike=!1,_czc.push(["_trackEvent","qanything","问答页面","点赞","",""]),e.like){t.target.parentNode.style.animation="shake ease-in .5s";const n=setTimeout(()=>{clearTimeout(n),t.target.parentNode.style.animation=""},600)}},800),Ne=e=>{e.unlike=!e.unlike,e.like=!1,_czc.push(["_trackEvent","qanything","问答页面","点踩","",""])},Pe=e=>{U(e.answer).then(()=>{e.copied=!e.copied,D.success(u.copySuccess,1);const t=setTimeout(()=>{clearTimeout(t),e.copied=!e.copied},1e3)}).catch(()=>{D.error(u.copyFailed,1)})},Ue=e=>{c.value.push({question:e,type:"user"}),H()},we=e=>{c.value.push({answer:"",question:e,onlySearch:d.value.capabilities.onlySearch,type:"ai",copied:!1,like:!1,unlike:!1,source:[],showTools:!1})},X=new mt,je=e=>{ae.value=e},Ke=e=>{ne.value=e},Se=(e,t,n)=>{try{V(e,t,n)}catch(l){D.error(l.msg||"更新对话失败")}};function ze(){if(!g.value.length)return;const e=[];g.value.forEach(t=>{w.value.some(n=>n.kb_id===t)&&e.push(t)}),g.value=e,P.value.forEach(t=>{b.value!==null&&t.historyId===b.value&&t.kbIds.join("")!==g.value.join("")&&Se(t.title,t.historyId,g.value)})}const Me=()=>{B&&B.abort("停止对话"),i.done(),S.value=!1,c.value[c.value.length-1].showTools=!0},Ve=e=>{try{if(b.value!==null)return;e.length>100&&(e=e.substring(0,100)),b.value=q(e),Se(e,b.value,g.value)}catch(t){D.error(t.msg||"创建对话失败")}},ve=async()=>{if(!a.value.trim().length)return;if(S.value){D.warn("正在聊天中...请等待结束");return}if(!await at()){D.error("模型设置错误，请先检查模型配置");return}if(ze(),g.value.length)D.info({content:u.type==="zh"?`已选择 ${g.value.length} 个知识库进行问答`:` ${g.value.length} knowledge base has been selected`,icon:" "});else return D.warning(u.chooseError);const e=a.value;Ve(e),a.value="",Ue(e),E(b.value,c.value),S.value=!0,B=new AbortController;const t={kb_ids:g.value,history:W.value,question:e,streaming:d.value.capabilities.onlySearch===!1,networking:d.value.capabilities.networkSearch,product_source:"saas",rerank:d.value.capabilities.rerank,only_need_search_results:d.value.capabilities.onlySearch,hybrid_search:d.value.capabilities.mixedSearch,max_token:d.value.maxToken,api_base:d.value.apiBase,api_key:d.value.apiKey,model:d.value.apiModelName,api_context_length:d.value.apiContextLength,chunk_size:d.value.chunkSize,top_p:d.value.top_P,top_k:d.value.top_K,temperature:d.value.temperature};if(d.value.capabilities.onlySearch){X.addChatSetting(d.value),we(e);try{const n=await Oe(await ye.sendQuestion(t,{signal:B.signal}));n.code===200&&(c.value[c.value.length-1].answer=n!=null&&n.source_documents.length?u.searchCompleted:u.searchNotFound,c.value[c.value.length-1].source=n==null?void 0:n.source_documents)}catch(n){console.log("出错",n),c.value[c.value.length-1].answer=n.msg||"error"}S.value=!1,c.value[c.value.length-1].showTools=!0,E(b.value,c.value),await z(()=>{H()})}else Ct(gt+"/local_doc_qa/local_doc_chat",{method:"POST",headers:{"Content-Type":"application/json",Accept:["text/event-stream","application/json"]},openWhenHidden:!0,body:JSON.stringify({user_id:ft,...t}),signal:B.signal,onopen(n){console.log("open",n),we(e),n.ok&&n.headers.get("content-type")==="text/event-stream"?(X.addChatSetting(d.value),i.start()):n.headers.get("content-type")==="application/json"&&i.add("Error 请检查模型是否配置正确")},onmessage(n){var F,r;console.log("message",n);const l=JSON.parse(n.data);if((l==null?void 0:l.code)==200&&(l!=null&&l.response)&&l.msg==="success")i.add(l==null?void 0:l.response),H();else{const $=l.time_record.time_usage;delete $.retriever_search_by_milvus,X.addTime(l.time_record.time_usage),X.addToken(l.time_record.token_usage),X.addDate(Date.now())}(F=l==null?void 0:l.source_documents)!=null&&F.length&&(c.value[c.value.length-1].source=l==null?void 0:l.source_documents),(r=l==null?void 0:l.show_images)!=null&&r.length&&(l==null||l.show_images.map($=>{i.add($),console.log(c.value.at(-1).answer)}))},onclose(n){console.log("close",n),i.done(),B.abort(),S.value=!1,c.value[c.value.length-1].showTools=!0,c.value.at(-1).itemInfo=X.getChatInfo(),E(b.value,c.value),z(()=>{H()})},onerror(n){throw console.log("error",n),i==null||i.done(),B==null||B.abort(),S.value=!1,c.value[c.value.length-1].showTools=!0,D.error(n.msg||"出错了"),E(b.value,c.value),z(()=>{H()}),n}})},Ye=e=>{console.log("reAnswer"),a.value=e.question,ve()},Je=(e,t)=>{e.source[t].showDetailDataSource=!e.source[t].showDetailDataSource},Xe=(e,t)=>{e.source[t].showDetailDataSource=!1},Ze=e=>{O.value.push(e)},We=e=>{O.value=O.value.filter(t=>t!==e)},{showModal:_e}=Q(Te()),fe=I(!1),le=I(""),G=I(""),Ge=()=>{S.value||(G.value="download",_e.value=!0,le.value=u.saveTip)},et=()=>{S.value||(G.value="delete",_e.value=!0,le.value=u.clearTip)},tt=async()=>{if(fe.value=!0,G.value==="download"){console.log("download");try{const e=document.getElementById("chat-ul"),n=(await wt(e,{useCORS:!0})).toDataURL("image/png"),l=document.createElement("a");l.style.display="none",l.href=n,l.setAttribute("download","chat-shot.png"),typeof l.download>"u"&&l.setAttribute("target","_blank"),document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n),D.success("下载成功"),Promise.resolve()}catch(e){console.log(e),D.error(e.message||e.msg||"出错了")}}else G.value==="delete"&&(console.log("delete"),Y(b.value),b.value=null,c.value=[]);G.value="",le.value="",fe.value=!1,_e.value=!1},{showSettingModal:st}=Q(Te()),ot=e=>{st.value=e},Ie=I(),at=()=>Ie.value.handleOk();let De=["pdf","docx","xlsx","txt","md","jpg","png","jpeg","csv","eml"];const Ae=e=>{if(!e)return!1;const t=e.split(".");if(t.length){const n=t.pop();return!!De.includes(n)}else return!1},nt=e=>{console.log("handleChatSource",e),Ae(e.file_name)&&lt(e)};async function lt(e){try{k(null);const t=await Oe(await ye.getFile({file_id:e.file_id}));console.log("queryFile",t);const n=e.file_name.split(".").pop(),l=it(n);if(console.log("b64Type",l),h(n),k(`data:${l};base64,${t.file_base64}`),n==="txt"||n==="md"||n==="csv"||n==="eml"){const F=atob(t.file_base64),r=decodeURIComponent(escape(F));console.log("decodedTxt",r),f(r),J(!0)}else J(!0)}catch(t){D.error(t.msg||"获取文件失败")}}let ct=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain","text/markdown","image/jpeg","image/png","image/jpeg","text/csv","message/rfc822","application/vnd.openxmlformats-officedocument.presentationml.presentation"];function it(e){const t=De.indexOf(e);return ct[t]}function rt(){console.log("清空")}return(e,t)=>{const n=Tt,l=Bt,F=Et;return _(),m(ee,null,[p(us,{observer:s(ke),"observe-dom":s(ae),"qa-observe-dom":s(ne),"qa-observer":s(Ce),"show-loading":s(S),onScrollBottom:H,onSetObserveDom:je,onSetQaObserverDom:Ke,onClearHistory:rt},null,8,["observer","observe-dom","qa-observe-dom","qa-observer","show-loading"]),o("div",ds,[o("div",hs,[o("div",{id:"chat",ref_key:"chatContainer",ref:Fe,class:"chat showSider"},[o("ul",{id:"chat-ul",ref_key:"scrollDom",ref:be},[(_(!0),m(ee,null,me(s(c),(r,$)=>{var Le,xe;return _(),m("li",{key:$},[r.type==="user"?(_(),m("div",ps,[vs,o("p",_s,y(r.question),1)])):(_(),m("div",fs,[gs,o("div",ms,[o("div",ys,[o("p",{class:R(["question-text",[!r.source.length&&!((Le=r==null?void 0:r.picList)!=null&&Le.length)?"change-radius":"",r.showTools?"":"flashing"]])},[p(Be,{content:r.answer.toString()},null,8,["content"]),Object.keys(((xe=r==null?void 0:r.itemInfo)==null?void 0:xe.tokenInfo)||{}).length?(_(),re(qt,{key:0,"chat-item-info":r.itemInfo},null,8,["chat-item-info"])):M("",!0)],2),r.source.length?(_(),m(ee,{key:0},[o("div",{class:R(["source-total",s(O).includes($)?"":"source-total-last"])},[s(A)==="zh"?(_(),m("span",bs," 找到了"+y(r.source.length)+"个信息来源： ",1)):(_(),m("span",ks," Found "+y(r.source.length)+" source of information ",1)),j(p(L,{name:"down",onClick:C=>Ze($)},null,8,["onClick"]),[[K,!s(O).includes($)]]),j(p(L,{name:"up",onClick:C=>We($)},null,8,["onClick"]),[[K,s(O).includes($)]])],2),j(o("div",Cs,[(_(!0),m(ee,null,me(r.source,(C,ce)=>(_(),m("div",{key:ce,class:"data-source"},[j(o("p",ws,[o("span",Ss,y(s(u).dataSource)+y(ce+1)+":",1),C.file_url.startsWith("http")?(_(),m("a",{key:0,href:C.file_url,target:"_blank"},y(C.file_name),9,Is)):(_(),m("span",{key:1,class:R(["file",Ae(C.file_name)?"filename-active":""]),onClick:qe=>nt(C)},y(C.file_name),11,Ds)),j(p(L,{name:"iconup",onClick:qe=>Xe(r,ce)},null,8,["onClick"]),[[K,C.showDetailDataSource]]),j(p(L,{name:"icondown",onClick:qe=>Je(r,ce)},null,8,["onClick"]),[[K,!C.showDetailDataSource]])],512),[[K,C.file_name]]),p(vt,{name:"sourceitem"},{default:T(()=>[j(o("div",As,[p(Be,{content:C.content},null,8,["content"]),o("p",Ls,[o("span",xs,y(s(u).correlation),1),Z(" "+y(C.score),1)])],512),[[K,C.showDetailDataSource]])]),_:2},1024)]))),128))],512),[[K,s(O).includes($)]])],64)):M("",!0),r.showTools?(_(),m("div",qs,[o("div",{class:"reload-box",onClick:C=>Ye(r)},[p(L,{name:"reload"}),o("span",Os,y(s(u).regenerate),1)],8,$s),o("div",Ts,[p(L,{style:ge({color:r.copied?"#4D71FF":""}),name:"copy",onClick:C=>Pe(r)},null,8,["style","onClick"]),p(L,{style:ge({color:r.like?"#4D71FF":""}),name:"like",onClick:C=>s(Re)(r,C)},null,8,["style","onClick"]),p(L,{style:ge({color:r.unlike?"#4D71FF":""}),name:"unlike",onClick:C=>Ne(r)},null,8,["style","onClick"])])])):M("",!0)])])]))])}),128))],512)],512),s(S)?(_(),m("div",Bs,[p(n,{onClick:Me},{icon:T(()=>[p(L,{name:"stop",class:R(s(S)?"loading":"")},null,8,["class"])]),default:T(()=>[Z(" "+y(s(u).stop),1)]),_:1})])):M("",!0),o("div",Es,[o("div",Hs,[o("div",Fs,[p(l,{value:s(a),"onUpdate:value":t[0]||(t[0]=r=>_t(a)?a.value=r:null),class:"send-textarea","max-length":"200",bordered:!1,placeholder:s(u).problemPlaceholder,"auto-size":{minRows:1,maxRows:8},onKeydown:Qe},null,8,["value","placeholder"]),o("div",Qs,[p(F,{placement:"topLeft"},{content:T(()=>[Z(y(s(u).chatToPic),1)]),default:T(()=>[o("span",{class:R(["download",s(S)?"isPreventClick":""]),onClick:Ge},[p(L,{name:"chat-download"})],2)]),_:1}),p(F,null,{content:T(()=>[Z(y(s(u).clearChat),1)]),default:T(()=>[o("span",{class:R(["delete",s(S)?"isPreventClick":""]),onClick:et},[p(L,{name:"chat-delete"})],2)]),_:1}),p(F,null,{content:T(()=>[Z(y(s(u).modelSettingTitle),1)]),default:T(()=>[o("span",{class:"setting",onClick:t[1]||(t[1]=r=>ot(!0))},[p(L,{name:"chat-setting"})])]),_:1}),p(n,{type:"primary",disabled:s(S),shape:"circle",onClick:ve},{default:T(()=>[p(L,{name:"sendplane"})]),_:1},8,["disabled"])])])])])]),o("div",{class:"scroll-btn-div"},[o("img",{class:"avatar",src:At,alt:"滑到底部",onClick:H})])]),p($t,{ref_key:"chatSettingForDialogRef",ref:Ie},null,512),p(kt,{content:s(le),"confirm-loading":s(fe),onOk:tt},null,8,["content","confirm-loading"])],64)}}}),Ns=oe(Rs,[["__scopeId","data-v-ed5d54b1"]]),Ps={class:"page"},Us={class:"container"},js={key:0,class:"initing"},Ks=se({__name:"Home",setup(v){const{showDefault:u}=Q(te()),{setDefault:i,getList:g}=te(),w=c=>{i(c),g()};return Ee(()=>{g()}),(c,b)=>(_(),m("div",Ps,[o("div",Us,[s(u)===s(ie).initing?(_(),m("div",js)):M("",!0),s(u)===s(ie).default?(_(),re(es,{key:1,onChange:w})):s(u)===s(ie).normal?(_(),re(Ns,{key:2})):s(u)===s(ie).optionlist?(_(),re(Lt,{key:3})):M("",!0)])]))}}),fo=oe(Ks,[["__scopeId","data-v-9dc9deec"]]);export{fo as default};
